{"version":3,"sources":["../src/step_icon_select.js"],"names":["define","$","notification","templates","ajax","Dialogue","StepIconSelector","prototype","rebind_buttons","console","log","unbind","click","showConfig","bind","event","self","iconsData","JSON","parse","val","clickedButton","target","render","done","html","initIconConfig","fail","exception","popup","body","getContent","on","e","iconContainer","parent","iconName","data","stepId","trigger","children","remove","append","close","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle opening a dialogue to configure scale data.\n *\n * @module     mod_roadmap/stepiconselect\n * @package    mod_roadmap\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/notification', 'core/templates', 'core/ajax', 'mod_roadmap/dialogue'],\n    function($, notification, templates, ajax, Dialogue) {\n\n        var StepIconSelector = function() {\n\n        };\n\n        StepIconSelector.prototype.rebind_buttons = function() {\n            console.log('StepIconSelector.prototype.rebind_buttons');\n            $('.btn_icon_selector').unbind('click').click(this.showConfig.bind(this));\n\n        };\n\n        StepIconSelector.prototype.showConfig = function(event) {\n            console.log('StepIconSelector.prototype.showConfig');\n            var self = this;\n            var iconsData = JSON.parse($('input[name=\"icon_data\"]').val());\n            self.clickedButton = event.target;\n\n            // Dish up the form.\n            templates.render('mod_roadmap/configuration_iconselect', iconsData)\n                .done(function(html) {\n                    new Dialogue(\n                        'Select Icon for Cycle',\n                        html,\n                        self.initIconConfig.bind(self)\n                    );\n                }).fail(notification.exception);\n        };\n\n        StepIconSelector.prototype.initIconConfig = function(popup) {\n            console.log('StepIconSelector.prototype.initIconConfig');\n            this.popup = popup;\n            var body = $(popup.getContent());\n            //if (this.originalscaleid === this.scaleid) {\n\n            //}\n            body.on('click', 'img.icon', function(e) {\n                let iconContainer = $(e.target).parent('.icon-container');\n                let iconName = iconContainer.data('iconname');\n                let stepId = $(this.clickedButton).data('stepid');\n                $('input[name=\"step-'+stepId+'-icon\"]').val(iconName).trigger('change');\n                $('input[name=\"step-'+stepId+'-icon\"]').parent('.step-icon-display').children('img').remove();\n                $('input[name=\"step-'+stepId+'-icon\"]').parent('.step-icon-display').append($(e.target));\n                popup.close();\n            }.bind(this));\n            body.on('click', '[data-action=\"cancel\"]', function() {\n                popup.close();\n            });\n        };\n\n        return {\n\n            /**\n             * Main initialisation.\n             *\n             * @param {String} selectSelector The select box selector.\n             * @param {String} inputSelector The hidden input field selector.\n             * @param {String} triggerSelector The trigger selector.\n             * @return {ScaleConfig} A new instance of ScaleConfig.\n             * @method init\n             */\n            init: function() {\n                return new StepIconSelector();\n            },\n\n            rebind_buttons: function() {\n                StepIconSelector.prototype.rebind_buttons();\n            }\n        };\n});"],"file":"step_icon_select.min.js"}