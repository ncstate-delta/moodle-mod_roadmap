{"version":3,"file":"roadmap_config.min.js","sources":["../src/roadmap_config.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap. Modernized version.\n *\n * @module     mod_roadmap/roadmapconfig\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'core/notification',\n    'core/templates',\n    'mod_roadmap/expand_contract',\n    'mod_roadmap/learningobjectivesconfig',\n    'mod_roadmap/step_icon_select',\n    'mod_roadmap/step_activity_select',\n    'mod_roadmap/step_save',\n    'mod_roadmap/cycle_save',\n    'mod_roadmap/phase_save',\n    'mod_roadmap/repository',\n    'core/modal_delete_cancel',\n    'core/modal_events'\n], (\n    $,\n    notification,\n    templates,\n    expandContract,\n    learningObjectives,\n    stepIconSelect,\n    stepActivitySelect,\n    stepSave,\n    cycleSave,\n    phaseSave,\n    roadmapRepo,\n    ModalDeleteCancel,\n    ModalEvents\n) => {\n\n    /**\n     * Shows a Moodle delete confirmation modal and resolves to true if confirmed, false otherwise.\n     * @param {string} message The message to show.\n     * @param {string} [title='Confirm delete'] The modal title.\n     * @returns {Promise<boolean>}\n     */\n    function showDeleteConfirmModal(message, title = 'Confirm delete') {\n        return new Promise((resolve) => {\n            ModalDeleteCancel.create({\n                title: title,\n                body: message\n            }).then(function(modal) {\n                modal.show();\n                modal.getRoot().on(ModalEvents.delete, function() {\n                    resolve(true);\n                    modal.hide();\n                });\n                modal.getRoot().on(ModalEvents.cancel, function() {\n                    resolve(false);\n                    modal.hide();\n                });\n                modal.getRoot().on(ModalEvents.hidden, function() {\n                    modal.destroy();\n                });\n            });\n        });\n    }\n\n    // Helper: Find the max ID for a given type\n    const getMaxValue = (dataType) => {\n        let ids = [];\n        $(`.${dataType}-wrapper`).each(function () {\n            const id = parseInt($(this).data(`${dataType}id`));\n            if (!isNaN(id)) {\n                ids.push(id);\n            }\n        });\n        return ids.length ? Math.max(...ids) : 0;\n    };\n\n    // Helper: Move wrapper up/down\n    const moveWrapper = ($wrapper, direction) => {\n        if (direction === 'up') {\n            const $prev = $wrapper.prev();\n            if ($prev.length) {\n                $wrapper.insertBefore($prev);\n            }\n        } else if (direction === 'down') {\n            const $next = $wrapper.next();\n            if ($next.length) {\n                $wrapper.insertAfter($next);\n            }\n        }\n    };\n\n    // Main class for roadmap config UI logic\n    class RoadmapConfig {\n        /**\n         * @param {String} inputSelector - Selector where config UI is injected.\n         * @param {String} inputConfig - Selector for hidden config input.\n         */\n        constructor(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n            this.initForm();\n        }\n\n        /**\n         * (Re)Initializes the roadmap configuration UI.\n         */\n        initForm() {\n            let inputConfigVal = this.configContainer.val();\n            if (!inputConfigVal) {\n                inputConfigVal = JSON.stringify({ phases: [] });\n                this.configContainer.val(inputConfigVal);\n            }\n            let config;\n            try {\n                config = JSON.parse(inputConfigVal);\n            } catch (e) {\n                notification.exception(e);\n                config = { phases: [] };\n            }\n\n            // Attach serialized config for template rendering\n            for (const phase of config.phases) {\n                phase.configuration = JSON.stringify(phase);\n                for (const cycle of (phase.cycles || [])) {\n                    cycle.configuration = JSON.stringify(cycle);\n                    for (const step of (cycle.steps || [])) {\n                        step.configuration = JSON.stringify(step);\n                    }\n                }\n            }\n\n            // Render UI\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then((html, js) => {\n                    templates.prependNodeContents(this.inputSelector, html, js);\n\n                    // Bind all event handlers\n                    this.bindExpandCollapseControls();\n\n                    // Delegated event binding for dynamic elements\n                    $('#roadmapconfiguration')\n                        .off('click', 'a[data-action]')\n                        .on('click', 'a[data-action]', (e) => this.clickHandler(e));\n\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]')); // Initial display\n\n                    learningObjectives.refreshChecklists();\n                    stepIconSelect.rebindButtons();\n                    stepActivitySelect.rebindButtons();\n                    stepSave.rebindInputs();\n                    cycleSave.rebindInputs();\n                    phaseSave.rebindInputs();\n                    this.bindConfigSave();\n\n                    require(['theme_boost/loader']);\n                })\n                .fail(notification.exception);\n\n            // Color pattern changes (live preview)\n            $('select[name=\"phasecolorpattern\"]').off('change').on('change', (e) => {\n                this.phaseColorChange($(e.target));\n            });\n        }\n\n        /**\n         * Handles all roadmap action links via event delegation.\n         * @param {Event} event The event object.\n         */\n        clickHandler(event) {\n            const $node = $(event.currentTarget);\n            const action = $node.data('action');\n            // All possible actions:\n            switch (action) {\n                case 'collapse_all_phases': return this.collapsePhases();\n                case 'expand_all_phases': return this.expandPhases();\n                case 'collapse_all_cycles':\n                    return this.collapseCycles($node.closest('.phase-wrapper')\n                        .find('.phase-cycles-container').first());\n                case 'expand_all_cycles':\n                    return this.expandCycles($node.closest('.phase-wrapper')\n                        .find('.phase-cycles-container').first());\n                case 'collapse_all_steps': return this.collapseSteps($node.parent('.step-container-controls')\n                    .next('.cycle-steps-container'));\n                case 'expand_all_steps': return this.expandSteps($node.parent('.step-container-controls')\n                    .next('.cycle-steps-container'));\n                case 'phase_collapse_control': return this.collapsePhase($node);\n                case 'cycle_collapse_control': return this.collapseCycle($node);\n                case 'step_collapse_control': return this.collapseStep($node);\n                case 'phase_delete_control': return this.deletePhase($node);\n                case 'cycle_delete_control': return this.deleteCycle($node);\n                case 'step_delete_control': return this.deleteStep($node);\n                case 'add_phase': return this.addPhase();\n                case 'phase_up_control': return this.upPhase($node);\n                case 'phase_down_control': return this.downPhase($node);\n                case 'add_phase_cycle': return this.addCycle($node);\n                case 'cycle_up_control': return this.upCycle($node);\n                case 'cycle_down_control': return this.downCycle($node);\n                case 'add_cycle_step': return this.addStep($node);\n                case 'step_up_control': return this.upStep($node);\n                case 'step_down_control': return this.downStep($node);\n            }\n        }\n\n        /**\n         * Show phase color pattern preview and update UI.\n         * @param {Object} $node The jQuery node for the color selector.\n         */\n        async phaseColorChange($node) {\n            const colorId = $node.val();\n            this.getColorSet(colorId);\n        }\n\n        /**\n         * Fetch and display a color pattern for phase UI.\n         * @param {string|number} colorId The color pattern identifier.\n         */\n        async getColorSet(colorId) {\n            $('.phase-color-display').remove();\n            let colors = [];\n            try {\n                colors = await roadmapRepo.fetchColorPattern(colorId);\n            } catch (e) {\n                notification.exception(e);\n            }\n            const $colorTable = $('<div>').addClass('phase-color-display');\n            for (const color of colors) {\n                $colorTable.append(`<div class=\"color\" style=\"background-color:${color}\"></div>`);\n            }\n            $('select[name=\"phasecolorpattern\"]').parent().append($colorTable);\n\n            // Color border for each phase\n            $('#roadmapconfiguration #phase-container > .phase-wrapper > div.row').each(function (i) {\n                const numColors = colors.length;\n                const idxColor = i % numColors;\n                $(this).css('border-bottom', `solid 1px ${colors[idxColor]}`);\n            });\n        }\n\n        /**\n         * Binds config save to all phase configuration changes.\n         */\n        bindConfigSave() {\n            $('input.phase-configuration').off('change').on('change', () => this.configSave());\n        }\n\n        /**\n         * Serializes the whole roadmap config and saves to hidden input.\n         */\n        configSave() {\n            const $phaseContainer = $('#phase-container');\n            const roadmapData = [];\n            let index = 0;\n            $phaseContainer.find('.phase-wrapper .phase-configuration').each(function () {\n                let phaseData = $(this).val() || '{}';\n                let phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index++;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({\n                phases: roadmapData,\n                phaseDeletes: $('#phase-deletes').val(),\n                cycleDeletes: $('#cycle-deletes').val(),\n                stepDeletes: $('#step-deletes').val(),\n            }));\n        }\n\n        /**\n         * Add a new phase.\n         */\n        addPhase() {\n            const config = JSON.parse($('input[name=\"roadmapconfiguration\"]').val());\n            const nextIndex = config.phases.length;\n            const maxPhaseId = getMaxValue('phase');\n            const newPhase = {\n                id: maxPhaseId + 1,\n                index: nextIndex,\n                number: nextIndex + 1,\n                title: 'Phase ' + (nextIndex + 1),\n                subtitle: 'Subtitle ' + (nextIndex + 1)\n            };\n            config.phases.push(newPhase);\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify(config));\n\n            templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then((html, js) => {\n                    templates.appendNodeContents('#phase-container', html, js);\n                    phaseSave.rebindInputs();\n                    this.bindConfigSave();\n                    // Ensure color pattern is applied to new phase\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n                }).fail(notification.exception);\n        }\n\n        /**\n         * Add a new cycle to a phase.\n         * @param {Object} $node The jQuery node that triggered the add cycle action.\n         */\n        addCycle($node) {\n            const $phaseContainer = $node.closest('.phase-container');\n            const $cycleContainer = $phaseContainer.children('.phase-cycles-container');\n            const nextCycleIndex = $cycleContainer.children('.cycle-wrapper').length;\n            const maxCycleId = getMaxValue('cycle');\n            const newCycle = {\n                id: maxCycleId + 1,\n                index: nextCycleIndex,\n                number: nextCycleIndex + 1,\n                title: 'Cycle ' + (nextCycleIndex + 1),\n                subtitle: 'Subtitle ' + (nextCycleIndex + 1)\n            };\n\n            templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then((html, js) => {\n                    templates.appendNodeContents($cycleContainer, html, js);\n                    learningObjectives.refreshChecklists();\n                    cycleSave.rebindInputs();\n                    phaseSave.rebindInputs();\n                }).fail(notification.exception);\n        }\n\n        /**\n         * Add a new step to a cycle.\n         * @param {Object} $node The jQuery node that triggered the add step action.\n         */\n        addStep($node) {\n            const $cycleContainer = $node.closest('.cycle-container');\n            const $stepsContainer = $cycleContainer.children('.cycle-steps-container');\n            const nextStepIndex = $stepsContainer.children('.step-wrapper').length;\n            const maxStepId = getMaxValue('step');\n            const iconUrl = $('input[name=\"icon_url\"]').val();\n\n            const newStep = {\n                id: maxStepId + 1,\n                index: nextStepIndex,\n                number: nextStepIndex + 1,\n                stepicon: 'icon-10',\n                iconurl: `${iconUrl}?name=icon-10&percent=100&flags=n`\n            };\n\n            templates.render('mod_roadmap/configuration_step', newStep)\n                .then((html, js) => {\n                    templates.appendNodeContents($stepsContainer, html, js);\n                    stepIconSelect.rebindButtons();\n                    stepActivitySelect.rebindButtons();\n                    stepSave.rebindInputs();\n                    cycleSave.rebindInputs();\n                }).fail(notification.exception);\n        }\n\n        // ---- Expand/Collapse controls ----\n\n        bindExpandCollapseControls() {\n            $('.expand-collapse-controls .collapse_everything').off('click').on('click', (e) => {\n                e.preventDefault();\n                this.collapseEverything();\n            });\n            $('.expand-collapse-controls .expand_everything').off('click').on('click', (e) => {\n                e.preventDefault();\n                this.expandEverything();\n            });\n        }\n\n        expandPhases() {\n            this.expandChildrenClass($('#roadmapconfiguration'), 'phase');\n        }\n        expandCycles(node) {\n            this.expandChildrenClass(node, 'cycle');\n        }\n        expandSteps(node) {\n            this.expandChildrenClass(node, 'step');\n        }\n        collapsePhases() {\n            const node = $('#roadmapconfiguration');\n            this.collapseCycles(node);\n            this.collapseChildrenClass(node, 'phase');\n        }\n        collapseCycles(node) {\n            this.collapseSteps(node);\n            this.collapseChildrenClass(node, 'cycle');\n        }\n        collapseSteps(node) {\n            this.collapseChildrenClass(node, 'step');\n        }\n        expandChildrenClass($parent, className) {\n            $parent.find(`a[data-action=\"${className}_collapse_control\"]`).each(function () {\n                const $wrapper = $(this).closest(`.${className}-wrapper`);\n                const $container = $wrapper.children(`.${className}-container`);\n                if ($container.hasClass('hide')) {\n                    $(this).click();\n                }\n            });\n        }\n        collapseChildrenClass($parent, className) {\n            $parent.find(`a[data-action=\"${className}_collapse_control\"]`).each(function () {\n                const $wrapper = $(this).closest(`.${className}-wrapper`);\n                const $container = $wrapper.children(`.${className}-container`);\n                if ($container.hasClass('visible')) {\n                    $(this).click();\n                }\n            });\n        }\n\n        /**\n         * Collapse a single phase.\n         * @param {Object} $node The jQuery node for the control.\n         */\n        collapsePhase($node) {\n            const $wrapper = $node.closest('.phase-wrapper');\n            const $container = $wrapper.children('.phase-container');\n            expandContract.expandCollapse($container, $node);\n        }\n\n        /**\n         * Collapse a single cycle.\n         * @param {Object} $node The jQuery node for the control.\n         */\n        collapseCycle($node) {\n            const $wrapper = $node.closest('.cycle-wrapper');\n            const $container = $wrapper.children('.cycle-container');\n            expandContract.expandCollapse($container, $node);\n        }\n\n        /**\n         * Collapse a single step.\n         * @param {Object} $node The jQuery node for the control.\n         */\n        collapseStep($node) {\n            const $wrapper = $node.closest('.step-wrapper');\n            const $container = $wrapper.children('.step-container');\n            expandContract.expandCollapse($container, $node);\n        }\n\n        // ---- Deletion ----\n\n        /**\n         * Delete a phase.\n         * @param {Object} $node The jQuery node for the delete control.\n         */\n        deletePhase($node) {\n            showDeleteConfirmModal('Are you sure you want to delete this Phase?', 'Confirm delete')\n                .then((confirmed) => {\n                    if (confirmed) {\n                        const $wrapper = $node.closest('.phase-wrapper');\n                        const phaseId = $wrapper.data('phaseid');\n                        $('#phase-deletes').val($('#phase-deletes').val() + phaseId + ',');\n                        $wrapper.remove();\n                        this.configSave();\n                        // Update color pattern after removal for consistency\n                        this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n                    }\n                });\n        }\n\n        /**\n         * Delete a cycle.\n         * @param {Object} $node The jQuery node for the delete control.\n         */\n        deleteCycle($node) {\n            showDeleteConfirmModal('Are you sure you want to delete this Cycle?', 'Confirm delete')\n                .then((confirmed) => {\n                    if (confirmed) {\n                        const $wrapper = $node.closest('.cycle-wrapper');\n                        const $phaseContainer = $node.closest('.phase-container');\n                        const cycleId = $wrapper.data('cycleid');\n                        $('#cycle-deletes').val($('#cycle-deletes').val() + cycleId + ',');\n                        $wrapper.remove();\n                        $phaseContainer.find('.phase-title').triggerHandler('change');\n                    }\n                });\n        }\n\n        /**\n         * Delete a step.\n         * @param {Object} $node The jQuery node for the delete control.\n         */\n        deleteStep($node) {\n            showDeleteConfirmModal('Are you sure you want to delete this Step?', 'Confirm delete')\n                .then((confirmed) => {\n                    if (confirmed) {\n                        const $wrapper = $node.closest('.step-wrapper');\n                        const $cycleContainer = $node.closest('.cycle-container');\n                        const stepId = $wrapper.data('stepid');\n                        $('#step-deletes').val($('#step-deletes').val() + stepId + ',');\n                        $wrapper.remove();\n                        $cycleContainer.find('.cycle-title').triggerHandler('change');\n                    }\n                });\n        }\n\n        // ---- Move up/down ----\n\n        upPhase($node) {\n            const $wrapper = $node.closest('.phase-wrapper');\n            moveWrapper($wrapper, 'up');\n            this.configSave();\n            this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n        }\n        downPhase($node) {\n            const $wrapper = $node.closest('.phase-wrapper');\n            moveWrapper($wrapper, 'down');\n            this.configSave();\n            this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n        }\n        upCycle($node) {\n            const $wrapper = $node.closest('.cycle-wrapper');\n            const $phaseContainer = $node.closest('.phase-container');\n            moveWrapper($wrapper, 'up');\n            $phaseContainer.find('.phase-title').triggerHandler('change');\n        }\n        downCycle($node) {\n            const $wrapper = $node.closest('.cycle-wrapper');\n            const $phaseContainer = $node.closest('.phase-container');\n            moveWrapper($wrapper, 'down');\n            $phaseContainer.find('.phase-title').triggerHandler('change');\n        }\n        upStep($node) {\n            const $wrapper = $node.closest('.step-wrapper');\n            const $cycleContainer = $node.closest('.cycle-container');\n            moveWrapper($wrapper, 'up');\n            $cycleContainer.find('.cycle-title').triggerHandler('change');\n        }\n        downStep($node) {\n            const $wrapper = $node.closest('.step-wrapper');\n            const $cycleContainer = $node.closest('.cycle-container');\n            moveWrapper($wrapper, 'down');\n            $cycleContainer.find('.cycle-title').triggerHandler('change');\n        }\n\n        // ---- Expand/collapse everything ----\n        expandEverything() {\n            this.expandPhases();\n        }\n        collapseEverything() {\n            this.collapsePhases();\n        }\n    }\n\n    return {\n        /**\n         * Main initialisation.\n         * @param {String} inputSelector The hidden input field selector.\n         * @param {String} inputConfig The hidden input configuration.\n         * @return {Object} RoadmapConfig instance\n         */\n        init: function (inputSelector, inputConfig) {\n            return new RoadmapConfig(inputSelector, inputConfig);\n        }\n    };\n});"],"names":["define","$","notification","templates","expandContract","learningObjectives","stepIconSelect","stepActivitySelect","stepSave","cycleSave","phaseSave","roadmapRepo","ModalDeleteCancel","ModalEvents","showDeleteConfirmModal","message","title","Promise","resolve","create","body","then","modal","show","getRoot","on","delete","hide","cancel","hidden","destroy","getMaxValue","dataType","ids","each","id","parseInt","this","data","isNaN","push","length","Math","max","moveWrapper","$wrapper","direction","$prev","prev","insertBefore","$next","next","insertAfter","RoadmapConfig","constructor","inputSelector","inputConfig","configContainer","initForm","config","inputConfigVal","val","JSON","stringify","phases","parse","e","exception","phase","configuration","cycle","cycles","step","steps","render","html","js","prependNodeContents","bindExpandCollapseControls","off","clickHandler","phaseColorChange","refreshChecklists","rebindButtons","rebindInputs","bindConfigSave","require","fail","target","event","$node","currentTarget","collapsePhases","expandPhases","collapseCycles","closest","find","first","expandCycles","collapseSteps","parent","expandSteps","collapsePhase","collapseCycle","collapseStep","deletePhase","deleteCycle","deleteStep","addPhase","upPhase","downPhase","addCycle","upCycle","downCycle","addStep","upStep","downStep","colorId","getColorSet","remove","colors","fetchColorPattern","$colorTable","addClass","color","append","i","idxColor","css","configSave","$phaseContainer","roadmapData","index","phaseData","phaseDataObj","phaseDeletes","cycleDeletes","stepDeletes","nextIndex","newPhase","number","subtitle","appendNodeContents","$cycleContainer","children","nextCycleIndex","newCycle","$stepsContainer","nextStepIndex","maxStepId","iconUrl","newStep","stepicon","iconurl","preventDefault","collapseEverything","expandEverything","expandChildrenClass","node","collapseChildrenClass","$parent","className","hasClass","click","$container","expandCollapse","confirmed","phaseId","cycleId","triggerHandler","stepId","init"],"mappings":"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"}