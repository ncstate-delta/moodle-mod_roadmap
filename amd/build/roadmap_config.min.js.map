{"version":3,"sources":["../src/roadmap_config.js"],"names":["define","$","notification","templates","ec","learningobjectives","stepiconselect","stepactivityselect","stepsave","cyclesave","phasesave","RoadmapConfig","inputSelector","inputConfig","configContainer","initForm","prototype","console","log","self","inputConfigVal","val","JSON","stringify","config","parse","phaseId","cycleId","stepId","each","phases","p","phase","id","number","index","configuration","cycles","c","cycle","steps","s","step","render","then","html","js","prependNodeContents","click","e","addPhase","addCycle","addStep","collapsePhase","collapseCycle","collapseStep","refresh_checklists","rebind_buttons","rebind_inputs","bindConfigSave","fail","exception","unbind","change","configSave","bind","phaseContainer","roadmapData","find","phaseData","phaseDataObj","push","event","preventDefault","stopPropagation","nextIndex","length","newPhase","appendNodeContents","thisnode","currentTarget","closest","cycleContainer","children","nextCycleIndex","totalCycles","stepsContainer","nextStepIndex","totalSteps","dtpdata","newStep","days","months","years","hours","minutes","stepicon","phaseWrapper","metadata","expandCollapse","cycleWrapper","init"],"mappings":"AAuBAA,OAAM,8BAAC,CAAC,QAAD,CAAW,mBAAX,CAAgC,gBAAhC,CAAkD,6BAAlD,CACC,sCADD,CACyC,8BADzC,CACyE,kCADzE,CAEC,uBAFD,CAE0B,wBAF1B,CAEoD,wBAFpD,CAAD,CAGF,SAASC,CAAT,CAAYC,CAAZ,CAA0BC,CAA1B,CAAqCC,CAArC,CAAyCC,CAAzC,CAA6DC,CAA7D,CACSC,CADT,CAC6BC,CAD7B,CACuCC,CADvC,CACkDC,CADlD,CAC6D,CAMzD,GAAIC,CAAAA,CAAa,CAAG,SAASC,CAAT,CAAwBC,CAAxB,CAAqC,CACrD,KAAKD,aAAL,CAAqBA,CAArB,CACA,KAAKE,eAAL,CAAuBb,CAAC,CAACY,CAAD,CAAxB,CAEA,KAAKE,QAAL,EACH,CALD,CAYAJ,CAAa,CAACK,SAAd,CAAwBD,QAAxB,CAAmC,UAAW,CAC1CE,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAD0C,GAEtCC,CAAAA,CAAI,CAAG,IAF+B,CAGtCC,CAAc,CAAG,KAAKN,eAAL,CAAqBO,GAArB,EAHqB,CAI1C,GAAsB,EAAlB,EAAAD,CAAJ,CAA0B,CACtBA,CAAc,CAAGE,IAAI,CAACC,SAAL,CAAe,CAAE,OAAS,EAAX,CAAf,CAAjB,CACA,KAAKT,eAAL,CAAqBO,GAArB,CAAyBD,CAAzB,CACH,CACD,GAAII,CAAAA,CAAM,CAAGF,IAAI,CAACG,KAAL,CAAWL,CAAX,CAAb,CAEAH,OAAO,CAACC,GAAR,CAAYM,CAAZ,EAV0C,GAWtCE,CAAAA,CAAO,CAAG,CAX4B,CAYtCC,CAAO,CAAG,CAZ4B,CAatCC,CAAM,CAAG,CAb6B,CAc1C3B,CAAC,CAAC4B,IAAF,CAAOL,CAAM,CAACM,MAAd,CAAsB,SAASC,CAAT,CAAY,CAC9B,GAAIC,CAAAA,CAAK,CAAGR,CAAM,CAACM,MAAP,CAAcC,CAAd,CAAZ,CACAL,CAAO,CAAGA,CAAO,CAAG,CAApB,CACAM,CAAK,CAACC,EAAN,CAAWP,CAAX,CACAM,CAAK,CAACE,MAAN,CAAeH,CAAC,CAAG,CAAnB,CACAC,CAAK,CAACG,KAAN,CAAcJ,CAAd,CACAC,CAAK,CAACI,aAAN,CAAsBd,IAAI,CAACC,SAAL,CAAeS,CAAf,CAAtB,CAEA/B,CAAC,CAAC4B,IAAF,CAAOG,CAAK,CAACK,MAAb,CAAqB,SAASC,CAAT,CAAY,CAC7B,GAAIC,CAAAA,CAAK,CAAGP,CAAK,CAACK,MAAN,CAAaC,CAAb,CAAZ,CACAX,CAAO,CAAGA,CAAO,CAAG,CAApB,CACAY,CAAK,CAACN,EAAN,CAAWN,CAAX,CACAY,CAAK,CAACL,MAAN,CAAeI,CAAC,CAAG,CAAnB,CACAC,CAAK,CAACJ,KAAN,CAAcG,CAAd,CACAC,CAAK,CAACH,aAAN,CAAsBd,IAAI,CAACC,SAAL,CAAegB,CAAf,CAAtB,CAEAtC,CAAC,CAAC4B,IAAF,CAAOU,CAAK,CAACC,KAAb,CAAoB,SAASC,CAAT,CAAY,CAC5B,GAAIC,CAAAA,CAAI,CAAGH,CAAK,CAACC,KAAN,CAAYC,CAAZ,CAAX,CACAb,CAAM,CAAGA,CAAM,CAAG,CAAlB,CACAc,CAAI,CAACT,EAAL,CAAUL,CAAV,CACAc,CAAI,CAACR,MAAL,CAAcO,CAAC,CAAG,CAAlB,CACAC,CAAI,CAACP,KAAL,CAAaM,CAAb,CACAC,CAAI,CAACN,aAAL,CAAqBd,IAAI,CAACC,SAAL,CAAemB,CAAf,CACxB,CAPD,CAQH,CAhBD,CAiBH,CAzBD,EA4BAvC,CAAS,CAACwC,MAAV,CAAiB,kCAAjB,CAAqDnB,CAArD,EACKoB,IADL,CACU,SAASC,CAAT,CAAeC,CAAf,CAAmB,CACrB3C,CAAS,CAAC4C,mBAAV,CAA8B5B,CAAI,CAACP,aAAnC,CAAkDiC,CAAlD,CAAwDC,CAAxD,EAEA7C,CAAC,CAAC,YAAD,CAAD,CAAgB+C,KAAhB,CAAsB,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBkC,QAAxB,CAAiCD,CAAjC,CAAsC,CAA1E,EACAhD,CAAC,CAAC,kBAAD,CAAD,CAAsB+C,KAAtB,CAA4B,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBmC,QAAxB,CAAiCF,CAAjC,CAAsC,CAAhF,EACAhD,CAAC,CAAC,iBAAD,CAAD,CAAqB+C,KAArB,CAA2B,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBoC,OAAxB,CAAgCH,CAAhC,CAAqC,CAA9E,EAEAhD,CAAC,CAAC,yBAAD,CAAD,CAA6B+C,KAA7B,CAAmC,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBqC,aAAxB,CAAsCJ,CAAtC,CAA2C,CAA5F,EACAhD,CAAC,CAAC,yBAAD,CAAD,CAA6B+C,KAA7B,CAAmC,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBsC,aAAxB,CAAsCL,CAAtC,CAA2C,CAA5F,EACAhD,CAAC,CAAC,wBAAD,CAAD,CAA4B+C,KAA5B,CAAkC,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBuC,YAAxB,CAAqCN,CAArC,CAA0C,CAA1F,EAEA5C,CAAkB,CAACmD,kBAAnB,GAEAlD,CAAc,CAACmD,cAAf,GACAlD,CAAkB,CAACkD,cAAnB,GAEAjD,CAAQ,CAACkD,aAAT,GACAjD,CAAS,CAACiD,aAAV,GACAhD,CAAS,CAACgD,aAAV,GAEA/C,CAAa,CAACK,SAAd,CAAwB2C,cAAxB,EACH,CAtBL,EAsBOC,IAtBP,CAsBY1D,CAAY,CAAC2D,SAtBzB,CAuBH,CAjED,CAmEAlD,CAAa,CAACK,SAAd,CAAwB2C,cAAxB,CAAyC,UAAW,CAChD1C,OAAO,CAACC,GAAR,CAAY,wCAAZ,EACAjB,CAAC,CAAC,2BAAD,CAAD,CAA+B6D,MAA/B,CAAsC,QAAtC,EAAgDC,MAAhD,CAAuD,KAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAvD,CACH,CAHD,CAKAtD,CAAa,CAACK,SAAd,CAAwBgD,UAAxB,CAAqC,UAAW,CAC5C/C,OAAO,CAACC,GAAR,CAAY,oCAAZ,EAD4C,GAExCgD,CAAAA,CAAc,CAAGjE,CAAC,CAAC,kBAAD,CAFsB,CAGxCkE,CAAW,CAAG,EAH0B,CAIxChC,CAAK,CAAG,CAJgC,CAK5ClC,CAAC,CAAC4B,IAAF,CAAOqC,CAAc,CAACE,IAAf,CAAoB,qCAApB,CAAP,CAAmE,UAAW,CAC1E,GAAIC,CAAAA,CAAS,CAAGpE,CAAC,CAAC,IAAD,CAAD,CAAQoB,GAAR,EAAhB,CACA,GAAiB,EAAb,EAAAgD,CAAJ,CAAqB,CAAEA,CAAS,CAAG,IAAO,CAC1C,GAAIC,CAAAA,CAAY,CAAGhD,IAAI,CAACG,KAAL,CAAW4C,CAAX,CAAnB,CACAC,CAAY,CAACnC,KAAb,CAAqBA,CAArB,CACAA,CAAK,CAAGA,CAAK,CAAG,CAAhB,CACAmC,CAAY,CAACrC,EAAb,CAAkBE,CAAlB,CACAgC,CAAW,CAACI,IAAZ,CAAiBD,CAAjB,CACH,CARD,EASArE,CAAC,CAAC,sCAAD,CAAD,CAAwCoB,GAAxC,CAA4CC,IAAI,CAACC,SAAL,CAAe,CAAEO,MAAM,CAAEqC,CAAV,CAAf,CAA5C,EACAlD,OAAO,CAACC,GAAR,CAAY,cAAZ,EACAD,OAAO,CAACC,GAAR,CAAY,CAAEY,MAAM,CAAEqC,CAAV,CAAZ,CACH,CAjBD,CAmBAxD,CAAa,CAACK,SAAd,CAAwBkC,QAAxB,CAAmC,SAASsB,CAAT,CAAgB,CAC/CvD,OAAO,CAACC,GAAR,CAAY,kCAAZ,EACAsD,CAAK,CAACC,cAAN,GACAD,CAAK,CAACE,eAAN,GAH+C,GAK3ClD,CAAAA,CAAM,CAAGF,IAAI,CAACG,KAAL,CAAWxB,CAAC,CAAC,sCAAD,CAAD,CAAwCoB,GAAxC,EAAX,CALkC,CAM3CsD,CAAS,CAAGnD,CAAM,CAACM,MAAP,CAAc8C,MANiB,CAO3CC,CAAQ,CAAG,CAAC5C,EAAE,CAAE0C,CAAS,CAAC,CAAf,CAAkBxC,KAAK,CAAEwC,CAAzB,CAAoCzC,MAAM,CAAEyC,CAAS,CAAC,CAAtD,CAPgC,CAQ/CnD,CAAM,CAACM,MAAP,CAAcyC,IAAd,CAAmBM,CAAnB,EACA5E,CAAC,CAAC,sCAAD,CAAD,CAAwCoB,GAAxC,CAA4CC,IAAI,CAACC,SAAL,CAAeC,CAAf,CAA5C,EAEArB,CAAS,CAACwC,MAAV,CAAiB,iCAAjB,CAAoDkC,CAApD,EACKjC,IADL,CACU,SAASC,CAAT,CAAeC,CAAf,CAAmB,CACrB3C,CAAS,CAAC2E,kBAAV,CAA6B,kBAA7B,CAAiDjC,CAAjD,CAAuDC,CAAvD,EAEA7C,CAAC,CAAC,yBAAD,CAAD,CAA6B6D,MAA7B,CAAoC,OAApC,EACKd,KADL,CACW,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBqC,aAAxB,CAAsCJ,CAAtC,CAA2C,CADpE,EAGAhD,CAAC,CAAC,YAAD,CAAD,CAAgB6D,MAAhB,CAAuB,OAAvB,EACKd,KADL,CACW,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBkC,QAAxB,CAAiCD,CAAjC,CAAsC,CAD/D,EAGAhD,CAAC,CAAC,kBAAD,CAAD,CAAsB6D,MAAtB,CAA6B,OAA7B,EACKd,KADL,CACW,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBmC,QAAxB,CAAiCF,CAAjC,CAAsC,CAD/D,EAGAvC,CAAS,CAACgD,aAAV,GACA/C,CAAa,CAACK,SAAd,CAAwB2C,cAAxB,EACH,CAfL,EAeOC,IAfP,CAeY1D,CAAY,CAAC2D,SAfzB,CAgBH,CA3BD,CA6BAlD,CAAa,CAACK,SAAd,CAAwBmC,QAAxB,CAAmC,SAASqB,CAAT,CAAgB,CAC/CvD,OAAO,CAACC,GAAR,CAAY,kCAAZ,EACAsD,CAAK,CAACC,cAAN,GACAD,CAAK,CAACE,eAAN,GAH+C,GAI3CK,CAAAA,CAAQ,CAAG9E,CAAC,CAACuE,CAAK,CAACQ,aAAP,CAJ+B,CAK3Cd,CAAc,CAAGa,CAAQ,CAACE,OAAT,CAAiB,kBAAjB,CAL0B,CAM3CC,CAAc,CAAGhB,CAAc,CAACiB,QAAf,CAAwB,yBAAxB,CAN0B,CAQ3CC,CAAc,CAAGF,CAAc,CAACC,QAAf,CAAwB,gBAAxB,EAA0CP,MARhB,CAS3CS,CAAW,CAAGpF,CAAC,CAAC,0CAAD,CAAD,CAA8C2E,MATjB,CAY/CzE,CAAS,CAACwC,MAAV,CAAiB,iCAAjB,CAFe,CAACV,EAAE,CAAEoD,CAAW,CAAC,CAAjB,CAAoBlD,KAAK,CAAEiD,CAA3B,CAA2ClD,MAAM,CAAEkD,CAAc,CAAC,CAAlE,CAEf,EACKxC,IADL,CACU,SAASC,CAAT,CAAeC,CAAf,CAAmB,CACrB3C,CAAS,CAAC2E,kBAAV,CAA6BI,CAA7B,CAA6CrC,CAA7C,CAAmDC,CAAnD,EAEA7C,CAAC,CAAC,yBAAD,CAAD,CAA6B6D,MAA7B,CAAoC,OAApC,EACKd,KADL,CACW,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBsC,aAAxB,CAAsCL,CAAtC,CAA2C,CADpE,EAGAhD,CAAC,CAAC,iBAAD,CAAD,CAAqB6D,MAArB,CAA4B,OAA5B,EACKd,KADL,CACW,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBoC,OAAxB,CAAgCH,CAAhC,CAAqC,CAD9D,EAGA5C,CAAkB,CAACmD,kBAAnB,GACA/C,CAAS,CAACiD,aAAV,GACAhD,CAAS,CAACgD,aAAV,EACH,CAbL,EAaOE,IAbP,CAaY1D,CAAY,CAAC2D,SAbzB,CAcH,CA1BD,CA4BAlD,CAAa,CAACK,SAAd,CAAwBoC,OAAxB,CAAkC,SAASoB,CAAT,CAAgB,CAC9CvD,OAAO,CAACC,GAAR,CAAY,iCAAZ,EACAsD,CAAK,CAACC,cAAN,GACAD,CAAK,CAACE,eAAN,GAH8C,GAI1CK,CAAAA,CAAQ,CAAG9E,CAAC,CAACuE,CAAK,CAACQ,aAAP,CAJ8B,CAK1CE,CAAc,CAAGH,CAAQ,CAACE,OAAT,CAAiB,kBAAjB,CALyB,CAM1CK,CAAc,CAAGJ,CAAc,CAACC,QAAf,CAAwB,wBAAxB,CANyB,CAQ1CI,CAAa,CAAGD,CAAc,CAACH,QAAf,CAAwB,eAAxB,EAAyCP,MARf,CAS1CY,CAAU,CAAGvF,CAAC,CAAC,eAAD,CAAD,CAAmB2E,MATU,CAU1Ca,CAAO,CAAGnE,IAAI,CAACG,KAAL,CAAWxB,CAAC,CAAC,oCAAD,CAAD,CAAsCoB,GAAtC,EAAX,CAVgC,CAW1CqE,CAAO,CAAG,CACVzD,EAAE,CAAEuD,CAAU,CAAC,CADL,CAEVrD,KAAK,CAAEoD,CAFG,CAGVrD,MAAM,CAAEqD,CAAa,CAAC,CAHZ,CAIVI,IAAI,CAAEF,CAAO,CAACE,IAJJ,CAKVC,MAAM,CAAEH,CAAO,CAACG,MALN,CAMVC,KAAK,CAAEJ,CAAO,CAACI,KANL,CAOVC,KAAK,CAAEL,CAAO,CAACK,KAPL,CAQVC,OAAO,CAAEN,CAAO,CAACM,OARP,CASVC,QAAQ,CAAE,SATA,CAXgC,CAuB9C7F,CAAS,CAACwC,MAAV,CAAiB,gCAAjB,CAAmD+C,CAAnD,EACK9C,IADL,CACU,SAASC,CAAT,CAAeC,CAAf,CAAmB,CACrB3C,CAAS,CAAC2E,kBAAV,CAA6BQ,CAA7B,CAA6CzC,CAA7C,CAAmDC,CAAnD,EAEA7C,CAAC,CAAC,wBAAD,CAAD,CAA4B6D,MAA5B,CAAmC,OAAnC,EACKd,KADL,CACW,SAASC,CAAT,CAAY,CAAEtC,CAAa,CAACK,SAAd,CAAwBuC,YAAxB,CAAqCN,CAArC,CAA0C,CADnE,EAGA3C,CAAc,CAACmD,cAAf,GACAlD,CAAkB,CAACkD,cAAnB,GACAjD,CAAQ,CAACkD,aAAT,GACAjD,CAAS,CAACiD,aAAV,EAEH,CAZL,EAYOE,IAZP,CAYY1D,CAAY,CAAC2D,SAZzB,CAaH,CApCD,CAsCAlD,CAAa,CAACK,SAAd,CAAwBqC,aAAxB,CAAwC,SAASmB,CAAT,CAAgB,CACpDvD,OAAO,CAACC,GAAR,CAAY,uCAAZ,EACAsD,CAAK,CAACC,cAAN,GACAD,CAAK,CAACE,eAAN,GAHoD,GAIhDK,CAAAA,CAAQ,CAAG9E,CAAC,CAACuE,CAAK,CAACQ,aAAP,CAJoC,CAKhDiB,CAAY,CAAGlB,CAAQ,CAACE,OAAT,CAAiB,gBAAjB,CALiC,CAMhDiB,CAAQ,CAAGD,CAAY,CAACd,QAAb,CAAsB,kBAAtB,CANqC,CAOpD/E,CAAE,CAAC+F,cAAH,CAAkBD,CAAlB,CAA4BnB,CAA5B,CACH,CARD,CAUApE,CAAa,CAACK,SAAd,CAAwBsC,aAAxB,CAAwC,SAASkB,CAAT,CAAgB,CACpDvD,OAAO,CAACC,GAAR,CAAY,uCAAZ,EACAsD,CAAK,CAACC,cAAN,GACAD,CAAK,CAACE,eAAN,GAHoD,GAIhDK,CAAAA,CAAQ,CAAG9E,CAAC,CAACuE,CAAK,CAACQ,aAAP,CAJoC,CAKhDoB,CAAY,CAAGrB,CAAQ,CAACE,OAAT,CAAiB,gBAAjB,CALiC,CAMhDiB,CAAQ,CAAGE,CAAY,CAACjB,QAAb,CAAsB,kBAAtB,CANqC,CAOpD/E,CAAE,CAAC+F,cAAH,CAAkBD,CAAlB,CAA4BnB,CAA5B,CACH,CARD,CAUApE,CAAa,CAACK,SAAd,CAAwBuC,YAAxB,CAAuC,SAASiB,CAAT,CAAgB,CACnDvD,OAAO,CAACC,GAAR,CAAY,sCAAZ,EACAsD,CAAK,CAACC,cAAN,GACAD,CAAK,CAACE,eAAN,GAHmD,GAI/CK,CAAAA,CAAQ,CAAG9E,CAAC,CAACuE,CAAK,CAACQ,aAAP,CAJmC,CAK/CoB,CAAY,CAAGrB,CAAQ,CAACE,OAAT,CAAiB,eAAjB,CALgC,CAM/CiB,CAAQ,CAAGE,CAAY,CAACjB,QAAb,CAAsB,iBAAtB,CANoC,CAOnD/E,CAAE,CAAC+F,cAAH,CAAkBD,CAAlB,CAA4BnB,CAA5B,CACH,CARD,CAUA,MAAO,CASHsB,IAAI,CAAE,cAASzF,CAAT,CAAwBC,CAAxB,CAAqC,CACvC,MAAO,IAAIF,CAAAA,CAAJ,CAAkBC,CAAlB,CAAiCC,CAAjC,CACV,CAXE,CAaV,CA3PC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap.\n *\n * @module     mod_roadmap/roadmapconfig\n * @package    mod_roadmap\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/notification', 'core/templates', 'mod_roadmap/expand_contract',\n        'mod_roadmap/learningobjectivesconfig', 'mod_roadmap/step_icon_select', 'mod_roadmap/step_activity_select',\n        'mod_roadmap/step_save', 'mod_roadmap/cycle_save', 'mod_roadmap/phase_save'],\n    function($, notification, templates, ec, learningobjectives, stepiconselect,\n             stepactivityselect, stepsave, cyclesave, phasesave) {\n\n        /**\n         * Learning objectives config object.\n         * @param {String} inputSelector The hidden input field selector.\n         */\n        var RoadmapConfig = function(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n\n            this.initForm();\n        };\n\n        /**\n         * Displays the scale configuration dialogue.\n         *\n         * @method initForm\n         */\n        RoadmapConfig.prototype.initForm = function() {\n            console.log('RoadmapConfig.prototype.initForm');\n            var self = this;\n            var inputConfigVal = this.configContainer.val();\n            if (inputConfigVal == '') {\n                inputConfigVal = JSON.stringify({ 'phases':[] });\n                this.configContainer.val(inputConfigVal);\n            }\n            var config = JSON.parse(inputConfigVal);\n\n            console.log(config);\n            var phaseId = 0;\n            var cycleId = 0;\n            var stepId = 0;\n            $.each(config.phases, function(p) {\n                let phase = config.phases[p];\n                phaseId = phaseId + 1;\n                phase.id = phaseId;\n                phase.number = p + 1;\n                phase.index = p;\n                phase.configuration = JSON.stringify(phase);\n\n                $.each(phase.cycles, function(c) {\n                    let cycle = phase.cycles[c];\n                    cycleId = cycleId + 1;\n                    cycle.id = cycleId;\n                    cycle.number = c + 1;\n                    cycle.index = c;\n                    cycle.configuration = JSON.stringify(cycle);\n\n                    $.each(cycle.steps, function(s) {\n                        let step = cycle.steps[s];\n                        stepId = stepId + 1;\n                        step.id = stepId;\n                        step.number = s + 1;\n                        step.index = s;\n                        step.configuration = JSON.stringify(step);\n                    });\n                });\n            });\n\n            // Dish up the form.\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then(function(html, js) {\n                    templates.prependNodeContents(self.inputSelector, html, js);\n\n                    $('#add-phase').click(function(e) { RoadmapConfig.prototype.addPhase(e); });\n                    $('.add-phase-cycle').click(function(e) { RoadmapConfig.prototype.addCycle(e); });\n                    $('.add-cycle-step').click(function(e) { RoadmapConfig.prototype.addStep(e); });\n\n                    $('.phase-collapse-control').click(function(e) { RoadmapConfig.prototype.collapsePhase(e); });\n                    $('.cycle-collapse-control').click(function(e) { RoadmapConfig.prototype.collapseCycle(e); });\n                    $('.step-collapse-control').click(function(e) { RoadmapConfig.prototype.collapseStep(e); });\n\n                    learningobjectives.refresh_checklists();\n\n                    stepiconselect.rebind_buttons();\n                    stepactivityselect.rebind_buttons();\n\n                    stepsave.rebind_inputs();\n                    cyclesave.rebind_inputs();\n                    phasesave.rebind_inputs();\n\n                    RoadmapConfig.prototype.bindConfigSave();\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.bindConfigSave = function() {\n            console.log('RoadmapConfig.prototype.bindConfigSave');\n            $('input.phase-configuration').unbind('change').change(this.configSave.bind(this));\n        };\n\n        RoadmapConfig.prototype.configSave = function() {\n            console.log('RoadmapConfig.prototype.configSave');\n            var phaseContainer = $('#phase-container');\n            var roadmapData = [];\n            let index = 0;\n            $.each(phaseContainer.find('.phase-wrapper .phase-configuration'), function() {\n                let phaseData = $(this).val();\n                if (phaseData == '') { phaseData = '{}'; }\n                let phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index;\n                index = index + 1;\n                phaseDataObj.id = index;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({ phases: roadmapData }));\n            console.log('Config Saved');\n            console.log({ phases: roadmapData });\n        };\n\n        RoadmapConfig.prototype.addPhase = function(event) {\n            console.log('RoadmapConfig.prototype.addPhase');\n            event.preventDefault();\n            event.stopPropagation();\n\n            var config = JSON.parse($('input[name=\"roadmapconfiguration\"]').val());\n            var nextIndex = config.phases.length;\n            var newPhase = {id: nextIndex+1, index: nextIndex, number: nextIndex+1};\n            config.phases.push(newPhase);\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify(config));\n\n            templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then(function(html, js) {\n                    templates.appendNodeContents('#phase-container', html, js);\n\n                    $('.phase-collapse-control').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.collapsePhase(e); });\n\n                    $('#add-phase').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.addPhase(e); });\n\n                    $('.add-phase-cycle').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.addCycle(e); });\n\n                    phasesave.rebind_inputs();\n                    RoadmapConfig.prototype.bindConfigSave();\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addCycle = function(event) {\n            console.log('RoadmapConfig.prototype.addCycle');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var phaseContainer = thisnode.closest('.phase-container');\n            var cycleContainer = phaseContainer.children('.phase-cycles-container');\n\n            var nextCycleIndex = cycleContainer.children('.cycle-wrapper').length;\n            var totalCycles = $('.phase-cycles-container > .cycle-wrapper').length;\n            var newCycle = {id: totalCycles+1, index: nextCycleIndex, number: nextCycleIndex+1};\n\n            templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then(function(html, js) {\n                    templates.appendNodeContents(cycleContainer, html, js);\n\n                    $('.cycle-collapse-control').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.collapseCycle(e); });\n\n                    $('.add-cycle-step').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.addStep(e); });\n\n                    learningobjectives.refresh_checklists();\n                    cyclesave.rebind_inputs();\n                    phasesave.rebind_inputs();\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addStep = function(event) {\n            console.log('RoadmapConfig.prototype.addStep');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var stepsContainer = cycleContainer.children('.cycle-steps-container');\n\n            var nextStepIndex = stepsContainer.children('.step-wrapper').length;\n            var totalSteps = $('.step-wrapper').length;\n            var dtpdata = JSON.parse($('input[name=\"datetimepickerdata\"]').val());\n            var newStep = {\n                id: totalSteps+1,\n                index: nextStepIndex,\n                number: nextStepIndex+1,\n                days: dtpdata.days,\n                months: dtpdata.months,\n                years: dtpdata.years,\n                hours: dtpdata.hours,\n                minutes: dtpdata.minutes,\n                stepicon: 'icon-10',\n            };\n\n            templates.render('mod_roadmap/configuration_step', newStep)\n                .then(function(html, js) {\n                    templates.appendNodeContents(stepsContainer, html, js);\n\n                    $('.step-collapse-control').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.collapseStep(e); });\n\n                    stepiconselect.rebind_buttons();\n                    stepactivityselect.rebind_buttons();\n                    stepsave.rebind_inputs();\n                    cyclesave.rebind_inputs();\n\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.collapsePhase = function(event) {\n            console.log('RoadmapConfig.prototype.collapsePhase');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var metadata = phaseWrapper.children('.phase-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseCycle = function(event) {\n            console.log('RoadmapConfig.prototype.collapseCycle');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var metadata = cycleWrapper.children('.cycle-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseStep = function(event) {\n            console.log('RoadmapConfig.prototype.collapseStep');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.step-wrapper');\n            var metadata = cycleWrapper.children('.step-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        return {\n\n            /**\n             * Main initialisation.\n             *\n             * @param {String} inputSelector The hidden input field selector.\n             * @return {LearningObjectivesConfig} A new instance of PhasesConfig.\n             * @method init\n             */\n            init: function(inputSelector, inputConfig) {\n                return new RoadmapConfig(inputSelector, inputConfig);\n            }\n        };\n    });\n"],"file":"roadmap_config.min.js"}