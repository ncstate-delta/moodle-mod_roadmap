{"version":3,"file":"roadmap_config.min.js","sources":["../src/roadmap_config.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap.\n *\n * @module     mod_roadmap/roadmapconfig\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'core/notification',\n        'core/templates',\n        'mod_roadmap/expand_contract',\n        'mod_roadmap/learningobjectivesconfig',\n        'mod_roadmap/step_icon_select',\n        'mod_roadmap/step_activity_select',\n        'mod_roadmap/step_save',\n        'mod_roadmap/cycle_save',\n        'mod_roadmap/phase_save',\n        'mod_roadmap/repository',\n    ],\n    function(\n        $,\n        notification,\n        templates,\n        ec,\n        learningobjectives,\n        stepiconselect,\n        stepactivityselect,\n        stepsave,\n        cyclesave,\n        phasesave,\n        roadmaprepository,\n    ) {\n\n        /**\n         * Learning objectives config object.\n         * @param {String} inputSelector The hidden input field selector.\n         * @param {String} inputConfig The hidden input configuration.\n         */\n        var RoadmapConfig = function(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n\n            this.initForm();\n        };\n\n        /**\n         * Use configuration data to fill phases, cycle, and step containers.\n         *\n         * @method initForm\n         */\n        RoadmapConfig.prototype.initForm = function() {\n            var self = this;\n            var inputConfigVal = this.configContainer.val();\n            if (inputConfigVal == '') {\n                inputConfigVal = JSON.stringify({'phases': []});\n                this.configContainer.val(inputConfigVal);\n            }\n            var config = JSON.parse(inputConfigVal);\n\n            $.each(config.phases, function(p) {\n                let phase = config.phases[p];\n                phase.configuration = JSON.stringify(phase);\n\n                $.each(phase.cycles, function(c) {\n                    let cycle = phase.cycles[c];\n                    cycle.configuration = JSON.stringify(cycle);\n\n                    $.each(cycle.steps, function(s) {\n                        let step = cycle.steps[s];\n                        step.configuration = JSON.stringify(step);\n                    });\n                });\n            });\n\n            // Dish up the form.\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then(function(html, js) {\n                    templates.prependNodeContents(self.inputSelector, html, js);\n\n                    $('#add-phase').click(function(e) {\n                        RoadmapConfig.prototype.addPhase(e);\n                    });\n                    $('.add-phase-cycle').click(function(e) {\n                        RoadmapConfig.prototype.addCycle(e);\n                    });\n                    $('.add-cycle-step').click(function(e) {\n                        RoadmapConfig.prototype.addStep(e);\n                    });\n\n                    $('.phase-collapse-control').click(function(e) {\n                        RoadmapConfig.prototype.collapsePhase(e);\n                    });\n                    $('.cycle-collapse-control').click(function(e) {\n                        RoadmapConfig.prototype.collapseCycle(e);\n                    });\n                    $('.step-collapse-control').click(function(e) {\n                        RoadmapConfig.prototype.collapseStep(e);\n                    });\n\n                    $('.phase-delete-control').click(function(e) {\n                        RoadmapConfig.prototype.deletePhase(e);\n                    });\n                    $('.cycle-delete-control').click(function(e) {\n                        RoadmapConfig.prototype.deleteCycle(e);\n                    });\n                    $('.step-delete-control').click(function(e) {\n                        RoadmapConfig.prototype.deleteStep(e);\n                    });\n\n                    $('.phase-up-control').click(function(e) {\n                        RoadmapConfig.prototype.upPhase(e);\n                    });\n                    $('.phase-down-control').click(function(e) {\n                        RoadmapConfig.prototype.downPhase(e);\n                    });\n                    $('.cycle-up-control').click(function(e) {\n                        RoadmapConfig.prototype.upCycle(e);\n                    });\n                    $('.cycle-down-control').click(function(e) {\n                        RoadmapConfig.prototype.downCycle(e);\n                    });\n                    $('.step-up-control').click(function(e) {\n                        RoadmapConfig.prototype.upStep(e);\n                    });\n                    $('.step-down-control').click(function(e) {\n                        RoadmapConfig.prototype.downStep(e);\n                    });\n\n                    $('.expand-collapse-controls .collapse_everything').click(function(e) {\n                        RoadmapConfig.prototype.collapseEverything(e);\n                    });\n                    $('.expand-collapse-controls .expand_everything').click(function(e) {\n                        RoadmapConfig.prototype.expandEverything(e);\n                    });\n\n                    // Instead of binding and unbinding specific elements over and over as they are created,\n                    // This event will capture all clicks, always and based on data we can determine the action.\n                    $('#roadmapconfiguration').click(RoadmapConfig.prototype.clickHandler);\n\n                    RoadmapConfig.prototype.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n\n                    learningobjectives.refreshChecklists();\n\n                    stepiconselect.rebindButtons();\n                    stepactivityselect.rebindButtons();\n\n                    stepsave.rebindInputs();\n                    cyclesave.rebindInputs();\n                    phasesave.rebindInputs();\n\n                    RoadmapConfig.prototype.bindConfigSave();\n\n                    require(['theme_boost/loader']);\n                    return null;\n                }).fail(notification.exception);\n\n            $('select[name=\"phasecolorpattern\"]').change(function(e) {\n                RoadmapConfig.prototype.phaseColorChange($(e.target));\n            });\n        };\n\n        RoadmapConfig.prototype.clickHandler = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.target);\n            var action = thisnode.data('action');\n\n            if (action == 'collapse_all_phases') {\n                RoadmapConfig.prototype.collapsePhases();\n            } else if (action == 'expand_all_phases') {\n                RoadmapConfig.prototype.expandPhases();\n            } else if (action == 'collapse_all_cycles') {\n                RoadmapConfig.prototype.collapseCycles(thisnode.parent('.cycle-container-controls')\n                    .next('.phase-cycles-container'));\n            } else if (action == 'expand_all_cycles') {\n                RoadmapConfig.prototype.expandCycles(thisnode.parent('.cycle-container-controls')\n                    .next('.phase-cycles-container'));\n            } else if (action == 'collapse_all_steps') {\n                RoadmapConfig.prototype.collapseSteps(thisnode.parent('.step-container-controls')\n                    .next('.cycle-steps-container'));\n            } else if (action == 'expand_all_steps') {\n                RoadmapConfig.prototype.expandSteps(thisnode.parent('.step-container-controls')\n                    .next('.cycle-steps-container'));\n            }\n        };\n\n        RoadmapConfig.prototype.phaseColorChange = function(node) {\n            var colorId = node.val();\n            RoadmapConfig.prototype.getColorSet(colorId);\n        };\n\n        RoadmapConfig.prototype.getColorSet = async(colorId) => {\n            $('.phase-color-display').remove();\n\n            const response = await roadmaprepository.fetchColorPattern(colorId);\n\n            var colorTable = $(\"<div>\").addClass('phase-color-display');\n            response.forEach(function(color) {\n                colorTable.append('<div class=\"color\" style=\"background-color:' + color + '\"/></div>');\n            });\n\n            $('select[name=\"phasecolorpattern\"]').parent().append(colorTable);\n\n            $('#roadmapconfiguration #phase-container > .phase-wrapper > div.row').each(function(index) {\n                let numcolors = response.length;\n                let idxcolor = index % numcolors;\n\n                $(this).css('border-bottom', 'solid 1px ' + response[idxcolor] + '');\n            });\n        };\n\n        RoadmapConfig.prototype.bindConfigSave = function() {\n            $('input.phase-configuration').unbind('change').change(this.configSave.bind(this));\n        };\n\n        RoadmapConfig.prototype.configSave = function() {\n            var phaseContainer = $('#phase-container');\n            var roadmapData = [];\n            let index = 0;\n            $.each(phaseContainer.find('.phase-wrapper .phase-configuration'), function() {\n                let phaseData = $(this).val();\n                if (phaseData == '') {\n                    phaseData = '{}';\n                }\n                let phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index;\n                index = index + 1;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({phases: roadmapData,\n                phaseDeletes: $('#phase-deletes').val(),\n                cycleDeletes: $('#cycle-deletes').val(),\n                stepDeletes: $('#step-deletes').val()\n            }));\n        };\n\n        RoadmapConfig.prototype.addPhase = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var config = JSON.parse($('input[name=\"roadmapconfiguration\"]').val());\n            var nextIndex = config.phases.length;\n            var maxPhaseId = parseInt(RoadmapConfig.prototype.maxValue('phase'));\n            var newPhase = {id: maxPhaseId + 1, index: nextIndex, number: nextIndex + 1};\n            config.phases.push(newPhase);\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify(config));\n\n            templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then(function(html, js) {\n                    templates.appendNodeContents('#phase-container', html, js);\n\n                    $('.phase-collapse-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.collapsePhase(e);\n                        });\n\n                    $('.phase-delete-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.deletePhase(e);\n                        });\n\n                    $('.phase-up-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.upPhase(e);\n                        });\n\n                    $('.phase-down-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.downPhase(e);\n                        });\n\n                    $('#add-phase').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.addPhase(e);\n                        });\n\n                    $('.add-phase-cycle').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.addCycle(e);\n                        });\n\n                    phasesave.rebindInputs();\n                    RoadmapConfig.prototype.bindConfigSave();\n                    return null;\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addCycle = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var phaseContainer = thisnode.closest('.phase-container');\n            var cycleContainer = phaseContainer.children('.phase-cycles-container');\n\n            var nextCycleIndex = cycleContainer.children('.cycle-wrapper').length;\n            let maxCycleId = parseInt(RoadmapConfig.prototype.maxValue('cycle'));\n            var newCycle = {id: maxCycleId + 1, index: nextCycleIndex, number: nextCycleIndex + 1};\n\n            templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then(function(html, js) {\n                    templates.appendNodeContents(cycleContainer, html, js);\n\n                    $('.cycle-collapse-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.collapseCycle(e);\n                        });\n\n                    $('.cycle-delete-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.deleteCycle(e);\n                        });\n\n                    $('.cycle-up-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.upCycle(e);\n                        });\n\n                    $('.cycle-down-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.downCycle(e);\n                        });\n\n                    $('.add-cycle-step').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.addStep(e);\n                        });\n\n                    learningobjectives.refreshChecklists();\n                    cyclesave.rebindInputs();\n                    phasesave.rebindInputs();\n                    return null;\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addStep = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var stepsContainer = cycleContainer.children('.cycle-steps-container');\n\n            var nextStepIndex = stepsContainer.children('.step-wrapper').length;\n            let maxStepId = parseInt(RoadmapConfig.prototype.maxValue('step'));\n            let iconUrl = $('input[name=\"icon_url\"]').val();\n\n            var newStep = {\n                id: maxStepId + 1,\n                index: nextStepIndex,\n                number: nextStepIndex + 1,\n                stepicon: 'icon-10',\n                iconurl: iconUrl + '?name=icon-10&percent=100&flags=n',\n            };\n\n            templates.render('mod_roadmap/configuration_step', newStep)\n                .then(function(html, js) {\n                    templates.appendNodeContents(stepsContainer, html, js);\n\n                    $('.step-collapse-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.collapseStep(e);\n                        });\n\n                    $('.step-delete-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.deleteStep(e);\n                        });\n\n                    $('.step-up-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.upStep(e);\n                        });\n\n                    $('.step-down-control').unbind('click')\n                        .click(function(e) {\n                            RoadmapConfig.prototype.downStep(e);\n                        });\n\n                    stepiconselect.rebindButtons();\n                    stepactivityselect.rebindButtons();\n                    stepsave.rebindInputs();\n                    cyclesave.rebindInputs();\n                    return null;\n                }).fail(notification.exception);\n        };\n\n        //* New expand all and contract all functionality *//\n        RoadmapConfig.prototype.expandPhases = function() {\n            RoadmapConfig.prototype.expandChildrenClass($('#roadmapconfiguration'), 'phase');\n        };\n\n        RoadmapConfig.prototype.expandCycles = function(node) {\n            RoadmapConfig.prototype.expandChildrenClass(node, 'cycle');\n        };\n\n        RoadmapConfig.prototype.expandSteps = function(node) {\n            RoadmapConfig.prototype.expandChildrenClass(node, 'step');\n        };\n\n        RoadmapConfig.prototype.collapsePhases = function() {\n            var node = $('#roadmapconfiguration');\n            RoadmapConfig.prototype.collapseCycles(node);\n            RoadmapConfig.prototype.collapseChildrenClass(node, 'phase');\n        };\n\n        RoadmapConfig.prototype.collapseCycles = function(node) {\n            RoadmapConfig.prototype.collapseSteps(node);\n            RoadmapConfig.prototype.collapseChildrenClass(node, 'cycle');\n        };\n\n        RoadmapConfig.prototype.collapseSteps = function(node) {\n            RoadmapConfig.prototype.collapseChildrenClass(node, 'step');\n        };\n\n        RoadmapConfig.prototype.expandChildrenClass = function(parentNode, groupingName) {\n\n            parentNode.find('a.' + groupingName + '-collapse-control').each(function() {\n                var wrapper = $(this).closest('.' + groupingName + '-wrapper');\n                var container = wrapper.children('.' + groupingName + '-container');\n                if (container.hasClass(\"hide\")) {\n                    $(this).click();\n                }\n            });\n        };\n\n        RoadmapConfig.prototype.collapseChildrenClass = function(parentNode, groupingName) {\n\n            parentNode.find('a.' + groupingName + '-collapse-control').each(function() {\n                var wrapper = $(this).closest('.' + groupingName + '-wrapper');\n                var container = wrapper.children('.' + groupingName + '-container');\n                if (container.hasClass(\"visible\")) {\n                    $(this).click();\n                }\n            });\n        };\n\n        RoadmapConfig.prototype.collapsePhase = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var metadata = phaseWrapper.children('.phase-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseCycle = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var metadata = cycleWrapper.children('.cycle-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseStep = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.step-wrapper');\n            var metadata = cycleWrapper.children('.step-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.deletePhase = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (window.confirm(\"Are you sure you want to delete this Phase?\")) {\n                var thisnode = $(event.currentTarget);\n                var phaseWrapper = thisnode.closest('.phase-wrapper');\n                var phaseId = phaseWrapper.data('phaseid');\n                $('#phase-deletes').val($('#phase-deletes').val() + phaseId + ',');\n                phaseWrapper.remove();\n                RoadmapConfig.prototype.configSave();\n            }\n        };\n\n        RoadmapConfig.prototype.deleteCycle = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (window.confirm(\"Are you sure you want to delete this Cycle?\")) {\n                var thisnode = $(event.currentTarget);\n                var cycleWrapper = thisnode.closest('.cycle-wrapper');\n                var phaseContainer = thisnode.closest('.phase-container');\n                var cycleId = cycleWrapper.data('cycleid');\n                $('#cycle-deletes').val($('#cycle-deletes').val() + cycleId + ',');\n                cycleWrapper.remove();\n                phaseContainer.find('.phase-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.deleteStep = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (window.confirm(\"Are you sure you want to delete this Step?\")) {\n                var thisnode = $(event.currentTarget);\n                var stepWrapper = thisnode.closest('.step-wrapper');\n                var cycleContainer = thisnode.closest('.cycle-container');\n                var stepId = stepWrapper.data('stepid');\n                $('#step-deletes').val($('#step-deletes').val() + stepId + ',');\n                stepWrapper.remove();\n                cycleContainer.find('.cycle-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.upPhase = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.currentTarget);\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var prevPhaseWrapper = phaseWrapper.prev();\n\n            phaseWrapper.insertBefore(prevPhaseWrapper);\n            RoadmapConfig.prototype.configSave();\n        };\n\n        RoadmapConfig.prototype.downPhase = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.currentTarget);\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var nextPhaseWrapper = phaseWrapper.next();\n\n            phaseWrapper.insertAfter(nextPhaseWrapper);\n            RoadmapConfig.prototype.configSave();\n        };\n\n        RoadmapConfig.prototype.upCycle = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var phaseContainer = thisnode.closest('.phase-container');\n            var prevCycleWrapper = cycleWrapper.prev();\n\n            if (prevCycleWrapper) {\n                cycleWrapper.insertBefore(prevCycleWrapper);\n                phaseContainer.find('.phase-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.downCycle = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var phaseContainer = thisnode.closest('.phase-container');\n            var nextCycleWrapper = cycleWrapper.next();\n\n            if (nextCycleWrapper) {\n                cycleWrapper.insertAfter(nextCycleWrapper);\n                phaseContainer.find('.phase-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.upStep = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.currentTarget);\n            var stepWrapper = thisnode.closest('.step-wrapper');\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var prevStepWrapper = stepWrapper.prev();\n\n            if (prevStepWrapper) {\n                stepWrapper.insertBefore(prevStepWrapper);\n                cycleContainer.find('.cycle-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.downStep = function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var thisnode = $(event.currentTarget);\n            var stepWrapper = thisnode.closest('.step-wrapper');\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var nextStepWrapper = stepWrapper.next();\n\n            if (nextStepWrapper) {\n                stepWrapper.insertAfter(nextStepWrapper);\n                cycleContainer.find('.cycle-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.maxValue = function(dataType) {\n            var arrID = new Array();\n            $('.' + dataType + '-wrapper').each(function() {\n                let stepId = parseInt($(this).data(dataType + 'id'));\n                if (isNaN(stepId) === false) {\n                    arrID.push(stepId);\n                }\n            });\n            var newArrID = arrID.sort(function(a, b) {\n                return a - b;\n            });\n\n            return newArrID[arrID.length - 1];\n        };\n\n        return {\n\n            /**\n             * Main initialisation.\n             *\n             * @param {String} inputSelector The hidden input field selector.\n             * @param {String} inputConfig The hidden input configuration.\n             * @return {LearningObjectivesConfig} A new instance of PhasesConfig.\n             * @method init\n             */\n            init: function(inputSelector, inputConfig) {\n                return new RoadmapConfig(inputSelector, inputConfig);\n            }\n        };\n    });\n"],"names":["define","$","notification","templates","ec","learningobjectives","stepiconselect","stepactivityselect","stepsave","cyclesave","phasesave","roadmaprepository","RoadmapConfig","inputSelector","inputConfig","configContainer","initForm","prototype","self","this","inputConfigVal","val","JSON","stringify","config","parse","each","phases","p","phase","configuration","cycles","c","cycle","steps","s","step","render","then","html","js","prependNodeContents","click","e","addPhase","addCycle","addStep","collapsePhase","collapseCycle","collapseStep","deletePhase","deleteCycle","deleteStep","upPhase","downPhase","upCycle","downCycle","upStep","downStep","collapseEverything","expandEverything","clickHandler","phaseColorChange","refreshChecklists","rebindButtons","rebindInputs","bindConfigSave","require","fail","exception","change","target","event","preventDefault","stopPropagation","thisnode","action","data","collapsePhases","expandPhases","collapseCycles","parent","next","expandCycles","collapseSteps","expandSteps","node","colorId","getColorSet","async","remove","response","fetchColorPattern","colorTable","addClass","forEach","color","append","index","idxcolor","length","css","unbind","configSave","bind","phaseContainer","roadmapData","find","phaseData","phaseDataObj","push","phaseDeletes","cycleDeletes","stepDeletes","nextIndex","newPhase","id","parseInt","maxValue","number","appendNodeContents","cycleContainer","currentTarget","closest","children","nextCycleIndex","newCycle","stepsContainer","nextStepIndex","newStep","stepicon","iconurl","expandChildrenClass","collapseChildrenClass","parentNode","groupingName","hasClass","metadata","expandCollapse","window","confirm","phaseWrapper","phaseId","cycleWrapper","cycleId","triggerHandler","stepWrapper","stepId","prevPhaseWrapper","prev","insertBefore","nextPhaseWrapper","insertAfter","prevCycleWrapper","nextCycleWrapper","prevStepWrapper","nextStepWrapper","dataType","arrID","Array","isNaN","sort","a","b","init"],"mappings":"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"}