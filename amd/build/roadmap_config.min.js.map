{"version":3,"file":"roadmap_config.min.js","sources":["../src/roadmap_config.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap.\n *\n * @module     mod_roadmap/roadmapconfig\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'core/notification',\n        'core/templates',\n        'mod_roadmap/expand_contract',\n        'mod_roadmap/learningobjectivesconfig',\n        'mod_roadmap/step_icon_select',\n        'mod_roadmap/step_activity_select',\n        'mod_roadmap/step_save',\n        'mod_roadmap/cycle_save',\n        'mod_roadmap/phase_save',\n        'mod_roadmap/repository',\n    ],\n    function(\n        $,\n        notification,\n        templates,\n        ec,\n        learningobjectives,\n        stepiconselect,\n        stepactivityselect,\n        stepsave,\n        cyclesave,\n        phasesave,\n        roadmaprepository,\n    ) {\n\n        /**\n         * Learning objectives config object.\n         * @param {String} inputSelector The hidden input field selector.\n         * @param {String} inputConfig The hidden input configuration.\n         */\n        var RoadmapConfig = function(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n\n            this.initForm();\n        };\n\n        /**\n         * Use configuration data to fill phases, cycle, and step containers.\n         *\n         * @method initForm\n         */\n        RoadmapConfig.prototype.initForm = function() {\n            var self = this;\n            var inputConfigVal = this.configContainer.val();\n            if (inputConfigVal == '') {\n                inputConfigVal = JSON.stringify({'phases': []});\n                this.configContainer.val(inputConfigVal);\n            }\n            var config = JSON.parse(inputConfigVal);\n\n            $.each(config.phases, function(p) {\n                let phase = config.phases[p];\n                phase.configuration = JSON.stringify(phase);\n\n                $.each(phase.cycles, function(c) {\n                    let cycle = phase.cycles[c];\n                    cycle.configuration = JSON.stringify(cycle);\n\n                    $.each(cycle.steps, function(s) {\n                        let step = cycle.steps[s];\n                        step.configuration = JSON.stringify(step);\n                    });\n                });\n            });\n\n            // Dish up the form.\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then(function(html, js) {\n                    templates.prependNodeContents(self.inputSelector, html, js);\n\n                    $('.expand-collapse-controls .collapse_everything').click(function(e) {\n                        RoadmapConfig.prototype.collapseEverything(e);\n                    });\n                    $('.expand-collapse-controls .expand_everything').click(function(e) {\n                        RoadmapConfig.prototype.expandEverything(e);\n                    });\n\n                    // Instead of binding and unbinding specific elements over and over as they are created,\n                    // This event will capture all clicks, always and based on data we can determine the action.\n                    $('#roadmapconfiguration a[data-action]').click(RoadmapConfig.prototype.clickHandler);\n\n                    RoadmapConfig.prototype.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n\n                    learningobjectives.refreshChecklists();\n\n                    stepiconselect.rebindButtons();\n                    stepactivityselect.rebindButtons();\n\n                    stepsave.rebindInputs();\n                    cyclesave.rebindInputs();\n                    phasesave.rebindInputs();\n\n                    RoadmapConfig.prototype.bindConfigSave();\n\n                    require(['theme_boost/loader']);\n                    return null;\n                }).fail(notification.exception);\n\n            $('select[name=\"phasecolorpattern\"]').change(function(e) {\n                RoadmapConfig.prototype.phaseColorChange($(e.target));\n            });\n        };\n\n        RoadmapConfig.prototype.clickHandler = function(event) {\n            let thisnode = $(event.currentTarget);\n            let action = thisnode.data('action');\n\n            if (action == 'collapse_all_phases') {\n                RoadmapConfig.prototype.collapsePhases();\n            } else if (action == 'expand_all_phases') {\n                RoadmapConfig.prototype.expandPhases();\n            } else if (action == 'collapse_all_cycles') {\n                RoadmapConfig.prototype.collapseCycles(thisnode.parent('.cycle-container-controls')\n                    .next('.phase-cycles-container'));\n            } else if (action == 'expand_all_cycles') {\n                RoadmapConfig.prototype.expandCycles(thisnode.parent('.cycle-container-controls')\n                    .next('.phase-cycles-container'));\n            } else if (action == 'collapse_all_steps') {\n                RoadmapConfig.prototype.collapseSteps(thisnode.parent('.step-container-controls')\n                    .next('.cycle-steps-container'));\n            } else if (action == 'expand_all_steps') {\n                RoadmapConfig.prototype.expandSteps(thisnode.parent('.step-container-controls')\n                    .next('.cycle-steps-container'));\n            } else if (action == 'phase_collapse_control') {\n                RoadmapConfig.prototype.collapsePhase(thisnode);\n            } else if (action == 'cycle_collapse_control') {\n                RoadmapConfig.prototype.collapseCycle(thisnode);\n            } else if (action == 'step_collapse_control') {\n                RoadmapConfig.prototype.collapseStep(thisnode);\n            } else if (action == 'phase_delete_control') {\n                RoadmapConfig.prototype.deletePhase(thisnode);\n            } else if (action == 'cycle_delete_control') {\n                RoadmapConfig.prototype.deleteCycle(thisnode);\n            } else if (action == 'step_delete_control') {\n                RoadmapConfig.prototype.deleteStep(thisnode);\n            } else if (action == 'add_phase') {\n                RoadmapConfig.prototype.addPhase();\n            } else if (action == 'phase_up_control') {\n                RoadmapConfig.prototype.upPhase(thisnode);\n            } else if (action == 'phase_down_control') {\n                RoadmapConfig.prototype.downPhase(thisnode);\n            } else if (action == 'add_phase_cycle') {\n                RoadmapConfig.prototype.addCycle(thisnode);\n            } else if (action == 'cycle_up_control') {\n                RoadmapConfig.prototype.upCycle(thisnode);\n            } else if (action == 'cycle_down_control') {\n                RoadmapConfig.prototype.downCycle(thisnode);\n            } else if (action == 'add_cycle_step') {\n                RoadmapConfig.prototype.addStep(thisnode);\n            } else if (action == 'step_up_control') {\n                RoadmapConfig.prototype.upStep(thisnode);\n            } else if (action == 'step_down_control') {\n                RoadmapConfig.prototype.downStep(thisnode);\n            }\n        };\n\n        RoadmapConfig.prototype.phaseColorChange = function(node) {\n            var colorId = node.val();\n            RoadmapConfig.prototype.getColorSet(colorId);\n        };\n\n        RoadmapConfig.prototype.getColorSet = async(colorId) => {\n            $('.phase-color-display').remove();\n\n            const response = await roadmaprepository.fetchColorPattern(colorId);\n\n            var colorTable = $(\"<div>\").addClass('phase-color-display');\n            response.forEach(function(color) {\n                colorTable.append('<div class=\"color\" style=\"background-color:' + color + '\"/></div>');\n            });\n\n            $('select[name=\"phasecolorpattern\"]').parent().append(colorTable);\n\n            $('#roadmapconfiguration #phase-container > .phase-wrapper > div.row').each(function(index) {\n                let numcolors = response.length;\n                let idxcolor = index % numcolors;\n\n                $(this).css('border-bottom', 'solid 1px ' + response[idxcolor] + '');\n            });\n        };\n\n        RoadmapConfig.prototype.bindConfigSave = function() {\n            $('input.phase-configuration').unbind('change').change(this.configSave.bind(this));\n        };\n\n        RoadmapConfig.prototype.configSave = function() {\n            var phaseContainer = $('#phase-container');\n            var roadmapData = [];\n            let index = 0;\n            $.each(phaseContainer.find('.phase-wrapper .phase-configuration'), function() {\n                let phaseData = $(this).val();\n                if (phaseData == '') {\n                    phaseData = '{}';\n                }\n                let phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index;\n                index = index + 1;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({phases: roadmapData,\n                phaseDeletes: $('#phase-deletes').val(),\n                cycleDeletes: $('#cycle-deletes').val(),\n                stepDeletes: $('#step-deletes').val()\n            }));\n        };\n\n        RoadmapConfig.prototype.addPhase = function() {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var config = JSON.parse($('input[name=\"roadmapconfiguration\"]').val());\n            var nextIndex = config.phases.length;\n            var maxPhaseId = parseInt(RoadmapConfig.prototype.maxValue('phase'));\n            var newPhase = {id: maxPhaseId + 1, index: nextIndex, number: nextIndex + 1};\n            config.phases.push(newPhase);\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify(config));\n\n            templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then(function(html, js) {\n                    templates.appendNodeContents('#phase-container', html, js);\n                    phasesave.rebindInputs();\n                    RoadmapConfig.prototype.bindConfigSave();\n                    return null;\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addCycle = function(thisnode) {\n            var phaseContainer = thisnode.closest('.phase-container');\n            var cycleContainer = phaseContainer.children('.phase-cycles-container');\n\n            var nextCycleIndex = cycleContainer.children('.cycle-wrapper').length;\n            let maxCycleId = parseInt(RoadmapConfig.prototype.maxValue('cycle'));\n            var newCycle = {id: maxCycleId + 1, index: nextCycleIndex, number: nextCycleIndex + 1};\n\n            templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then(function(html, js) {\n                    templates.appendNodeContents(cycleContainer, html, js);\n\n                    learningobjectives.refreshChecklists();\n                    cyclesave.rebindInputs();\n                    phasesave.rebindInputs();\n                    return null;\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addStep = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var stepsContainer = cycleContainer.children('.cycle-steps-container');\n\n            var nextStepIndex = stepsContainer.children('.step-wrapper').length;\n            let maxStepId = parseInt(RoadmapConfig.prototype.maxValue('step'));\n            let iconUrl = $('input[name=\"icon_url\"]').val();\n\n            var newStep = {\n                id: maxStepId + 1,\n                index: nextStepIndex,\n                number: nextStepIndex + 1,\n                stepicon: 'icon-10',\n                iconurl: iconUrl + '?name=icon-10&percent=100&flags=n',\n            };\n\n            templates.render('mod_roadmap/configuration_step', newStep)\n                .then(function(html, js) {\n                    templates.appendNodeContents(stepsContainer, html, js);\n\n                    stepiconselect.rebindButtons();\n                    stepactivityselect.rebindButtons();\n                    stepsave.rebindInputs();\n                    cyclesave.rebindInputs();\n                    return null;\n                }).fail(notification.exception);\n        };\n\n        //* New expand all and contract all functionality *//\n        RoadmapConfig.prototype.expandPhases = function() {\n            RoadmapConfig.prototype.expandChildrenClass($('#roadmapconfiguration'), 'phase');\n        };\n\n        RoadmapConfig.prototype.expandCycles = function(node) {\n            RoadmapConfig.prototype.expandChildrenClass(node, 'cycle');\n        };\n\n        RoadmapConfig.prototype.expandSteps = function(node) {\n            RoadmapConfig.prototype.expandChildrenClass(node, 'step');\n        };\n\n        RoadmapConfig.prototype.collapsePhases = function() {\n            var node = $('#roadmapconfiguration');\n            RoadmapConfig.prototype.collapseCycles(node);\n            RoadmapConfig.prototype.collapseChildrenClass(node, 'phase');\n        };\n\n        RoadmapConfig.prototype.collapseCycles = function(node) {\n            RoadmapConfig.prototype.collapseSteps(node);\n            RoadmapConfig.prototype.collapseChildrenClass(node, 'cycle');\n        };\n\n        RoadmapConfig.prototype.collapseSteps = function(node) {\n            RoadmapConfig.prototype.collapseChildrenClass(node, 'step');\n        };\n\n        RoadmapConfig.prototype.expandChildrenClass = function(parentNode, groupingName) {\n\n            parentNode.find('a[data-action=\"' + groupingName + '_collapse_control\"]').each(function() {\n                var wrapper = $(this).closest('.' + groupingName + '-wrapper');\n                var container = wrapper.children('.' + groupingName + '-container');\n                if (container.hasClass(\"hide\")) {\n                    $(this).click();\n                }\n            });\n        };\n\n        RoadmapConfig.prototype.collapseChildrenClass = function(parentNode, groupingName) {\n\n            parentNode.find('a[data-action=\"' + groupingName + '_collapse_control\"]').each(function() {\n                var wrapper = $(this).closest('.' + groupingName + '-wrapper');\n                var container = wrapper.children('.' + groupingName + '-container');\n                if (container.hasClass(\"visible\")) {\n                    $(this).click();\n                }\n            });\n        };\n\n        RoadmapConfig.prototype.collapsePhase = function(thisnode) {\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var metadata = phaseWrapper.children('.phase-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseCycle = function(thisnode) {\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var metadata = cycleWrapper.children('.cycle-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseStep = function(thisnode) {\n            var cycleWrapper = thisnode.closest('.step-wrapper');\n            var metadata = cycleWrapper.children('.step-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.deletePhase = function(thisnode) {\n            if (window.confirm(\"Are you sure you want to delete this Phase?\")) {\n                var phaseWrapper = thisnode.closest('.phase-wrapper');\n                var phaseId = phaseWrapper.data('phaseid');\n                $('#phase-deletes').val($('#phase-deletes').val() + phaseId + ',');\n                phaseWrapper.remove();\n                RoadmapConfig.prototype.configSave();\n            }\n        };\n\n        RoadmapConfig.prototype.deleteCycle = function(thisnode) {\n            if (window.confirm(\"Are you sure you want to delete this Cycle?\")) {\n                var cycleWrapper = thisnode.closest('.cycle-wrapper');\n                var phaseContainer = thisnode.closest('.phase-container');\n                var cycleId = cycleWrapper.data('cycleid');\n                $('#cycle-deletes').val($('#cycle-deletes').val() + cycleId + ',');\n                cycleWrapper.remove();\n                phaseContainer.find('.phase-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.deleteStep = function(thisnode) {\n            if (window.confirm(\"Are you sure you want to delete this Step?\")) {\n                var stepWrapper = thisnode.closest('.step-wrapper');\n                var cycleContainer = thisnode.closest('.cycle-container');\n                var stepId = stepWrapper.data('stepid');\n                $('#step-deletes').val($('#step-deletes').val() + stepId + ',');\n                stepWrapper.remove();\n                cycleContainer.find('.cycle-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.upPhase = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var prevPhaseWrapper = phaseWrapper.prev();\n\n            phaseWrapper.insertBefore(prevPhaseWrapper);\n            RoadmapConfig.prototype.configSave();\n        };\n\n        RoadmapConfig.prototype.downPhase = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var nextPhaseWrapper = phaseWrapper.next();\n\n            phaseWrapper.insertAfter(nextPhaseWrapper);\n            RoadmapConfig.prototype.configSave();\n        };\n\n        RoadmapConfig.prototype.upCycle = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var phaseContainer = thisnode.closest('.phase-container');\n            var prevCycleWrapper = cycleWrapper.prev();\n\n            if (prevCycleWrapper) {\n                cycleWrapper.insertBefore(prevCycleWrapper);\n                phaseContainer.find('.phase-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.downCycle = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var phaseContainer = thisnode.closest('.phase-container');\n            var nextCycleWrapper = cycleWrapper.next();\n\n            if (nextCycleWrapper) {\n                cycleWrapper.insertAfter(nextCycleWrapper);\n                phaseContainer.find('.phase-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.upStep = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var stepWrapper = thisnode.closest('.step-wrapper');\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var prevStepWrapper = stepWrapper.prev();\n\n            if (prevStepWrapper) {\n                stepWrapper.insertBefore(prevStepWrapper);\n                cycleContainer.find('.cycle-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.downStep = function(thisnode) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var stepWrapper = thisnode.closest('.step-wrapper');\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var nextStepWrapper = stepWrapper.next();\n\n            if (nextStepWrapper) {\n                stepWrapper.insertAfter(nextStepWrapper);\n                cycleContainer.find('.cycle-title').triggerHandler(\"change\");\n            }\n        };\n\n        RoadmapConfig.prototype.maxValue = function(dataType) {\n            var arrID = new Array();\n            $('.' + dataType + '-wrapper').each(function() {\n                let stepId = parseInt($(this).data(dataType + 'id'));\n                if (isNaN(stepId) === false) {\n                    arrID.push(stepId);\n                }\n            });\n            var newArrID = arrID.sort(function(a, b) {\n                return a - b;\n            });\n\n            return newArrID[arrID.length - 1];\n        };\n\n        return {\n\n            /**\n             * Main initialisation.\n             *\n             * @param {String} inputSelector The hidden input field selector.\n             * @param {String} inputConfig The hidden input configuration.\n             * @return {LearningObjectivesConfig} A new instance of PhasesConfig.\n             * @method init\n             */\n            init: function(inputSelector, inputConfig) {\n                return new RoadmapConfig(inputSelector, inputConfig);\n            }\n        };\n    });\n"],"names":["define","$","notification","templates","ec","learningobjectives","stepiconselect","stepactivityselect","stepsave","cyclesave","phasesave","roadmaprepository","RoadmapConfig","inputSelector","inputConfig","configContainer","initForm","prototype","self","this","inputConfigVal","val","JSON","stringify","config","parse","each","phases","p","phase","configuration","cycles","c","cycle","steps","s","step","render","then","html","js","prependNodeContents","click","e","collapseEverything","expandEverything","clickHandler","phaseColorChange","refreshChecklists","rebindButtons","rebindInputs","bindConfigSave","require","fail","exception","change","target","event","thisnode","currentTarget","action","data","collapsePhases","expandPhases","collapseCycles","parent","next","expandCycles","collapseSteps","expandSteps","collapsePhase","collapseCycle","collapseStep","deletePhase","deleteCycle","deleteStep","addPhase","upPhase","downPhase","addCycle","upCycle","downCycle","addStep","upStep","downStep","node","colorId","getColorSet","async","remove","response","fetchColorPattern","colorTable","addClass","forEach","color","append","index","idxcolor","length","css","unbind","configSave","bind","phaseContainer","roadmapData","find","phaseData","phaseDataObj","push","phaseDeletes","cycleDeletes","stepDeletes","preventDefault","stopPropagation","nextIndex","newPhase","id","parseInt","maxValue","number","appendNodeContents","cycleContainer","closest","children","nextCycleIndex","newCycle","stepsContainer","nextStepIndex","newStep","stepicon","iconurl","expandChildrenClass","collapseChildrenClass","parentNode","groupingName","hasClass","metadata","expandCollapse","window","confirm","phaseWrapper","phaseId","cycleWrapper","cycleId","triggerHandler","stepWrapper","stepId","prevPhaseWrapper","prev","insertBefore","nextPhaseWrapper","insertAfter","prevCycleWrapper","nextCycleWrapper","prevStepWrapper","nextStepWrapper","dataType","arrID","Array","isNaN","sort","a","b","init"],"mappings":"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"}