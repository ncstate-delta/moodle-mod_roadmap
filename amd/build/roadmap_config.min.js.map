{"version":3,"sources":["../src/roadmap_config.js"],"names":["define","$","notification","templates","ec","learningobjectives","stepiconselect","stepactivityselect","stepsave","cyclesave","phasesave","RoadmapConfig","inputSelector","inputConfig","configContainer","initForm","prototype","console","log","self","inputConfigVal","val","JSON","stringify","config","parse","phaseId","cycleId","stepId","each","phases","p","phase","id","number","index","configuration","cycles","c","cycle","steps","s","step","cleanstep","Object","assign","days","months","years","hours","minutes","render","then","html","js","prependNodeContents","click","e","addPhase","addCycle","addStep","collapsePhase","collapseCycle","collapseStep","refresh_checklists","rebind_buttons","rebind_inputs","bindConfigSave","fail","exception","unbind","change","configSave","bind","phaseContainer","roadmapData","find","phaseData","phaseDataObj","push","event","preventDefault","stopPropagation","nextIndex","length","newPhase","appendNodeContents","thisnode","currentTarget","closest","cycleContainer","children","nextCycleIndex","totalCycles","stepsContainer","nextStepIndex","totalSteps","dtpdata","newStep","stepicon","phaseWrapper","metadata","expandCollapse","cycleWrapper","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap.\n *\n * @module     mod_roadmap/roadmapconfig\n * @package    mod_roadmap\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/notification', 'core/templates', 'mod_roadmap/expand_contract',\n        'mod_roadmap/learningobjectivesconfig', 'mod_roadmap/step_icon_select', 'mod_roadmap/step_activity_select',\n        'mod_roadmap/step_save', 'mod_roadmap/cycle_save', 'mod_roadmap/phase_save'],\n    function($, notification, templates, ec, learningobjectives, stepiconselect,\n             stepactivityselect, stepsave, cyclesave, phasesave) {\n\n        /**\n         * Learning objectives config object.\n         * @param {String} inputSelector The hidden input field selector.\n         */\n        var RoadmapConfig = function(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n\n            this.initForm();\n        };\n\n        /**\n         * Displays the scale configuration dialogue.\n         *\n         * @method initForm\n         */\n        RoadmapConfig.prototype.initForm = function() {\n            console.log('RoadmapConfig.prototype.initForm');\n            var self = this;\n            var inputConfigVal = this.configContainer.val();\n            if (inputConfigVal == '') {\n                inputConfigVal = JSON.stringify({ 'phases':[] });\n                this.configContainer.val(inputConfigVal);\n            }\n            var config = JSON.parse(inputConfigVal);\n\n            console.log(config);\n            var phaseId = 0;\n            var cycleId = 0;\n            var stepId = 0;\n            $.each(config.phases, function(p) {\n                let phase = config.phases[p];\n                phaseId = phaseId + 1;\n                phase.id = phaseId;\n                phase.number = p + 1;\n                phase.index = p;\n                phase.configuration = JSON.stringify(phase);\n\n                $.each(phase.cycles, function(c) {\n                    let cycle = phase.cycles[c];\n                    cycleId = cycleId + 1;\n                    cycle.id = cycleId;\n                    cycle.number = c + 1;\n                    cycle.index = c;\n                    cycle.configuration = JSON.stringify(cycle);\n\n                    $.each(cycle.steps, function(s) {\n                        let step = cycle.steps[s];\n                        stepId = stepId + 1;\n                        step.id = stepId;\n                        step.number = s + 1;\n                        step.index = s;\n\n                        var cleanstep = Object.assign({}, step);\n                        delete cleanstep.days;\n                        delete cleanstep.months;\n                        delete cleanstep.years;\n                        delete cleanstep.hours;\n                        delete cleanstep.minutes;\n                        step.configuration = JSON.stringify(cleanstep);\n\n                    });\n                });\n            });\n\n            // Dish up the form.\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then(function(html, js) {\n                    templates.prependNodeContents(self.inputSelector, html, js);\n\n                    $('#add-phase').click(function(e) { RoadmapConfig.prototype.addPhase(e); });\n                    $('.add-phase-cycle').click(function(e) { RoadmapConfig.prototype.addCycle(e); });\n                    $('.add-cycle-step').click(function(e) { RoadmapConfig.prototype.addStep(e); });\n\n                    $('.phase-collapse-control').click(function(e) { RoadmapConfig.prototype.collapsePhase(e); });\n                    $('.cycle-collapse-control').click(function(e) { RoadmapConfig.prototype.collapseCycle(e); });\n                    $('.step-collapse-control').click(function(e) { RoadmapConfig.prototype.collapseStep(e); });\n\n                    learningobjectives.refresh_checklists();\n\n                    stepiconselect.rebind_buttons();\n                    stepactivityselect.rebind_buttons();\n\n                    stepsave.rebind_inputs();\n                    cyclesave.rebind_inputs();\n                    phasesave.rebind_inputs();\n\n                    RoadmapConfig.prototype.bindConfigSave();\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.bindConfigSave = function() {\n            console.log('RoadmapConfig.prototype.bindConfigSave');\n            $('input.phase-configuration').unbind('change').change(this.configSave.bind(this));\n        };\n\n        RoadmapConfig.prototype.configSave = function() {\n            console.log('RoadmapConfig.prototype.configSave');\n            var phaseContainer = $('#phase-container');\n            var roadmapData = [];\n            let index = 0;\n            $.each(phaseContainer.find('.phase-wrapper .phase-configuration'), function() {\n                let phaseData = $(this).val();\n                if (phaseData == '') { phaseData = '{}'; }\n                let phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index;\n                index = index + 1;\n                phaseDataObj.id = index;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({ phases: roadmapData }));\n            console.log('Config Saved');\n            console.log({ phases: roadmapData });\n        };\n\n        RoadmapConfig.prototype.addPhase = function(event) {\n            console.log('RoadmapConfig.prototype.addPhase');\n            event.preventDefault();\n            event.stopPropagation();\n\n            var config = JSON.parse($('input[name=\"roadmapconfiguration\"]').val());\n            var nextIndex = config.phases.length;\n            var newPhase = {id: nextIndex+1, index: nextIndex, number: nextIndex+1};\n            config.phases.push(newPhase);\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify(config));\n\n            templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then(function(html, js) {\n                    templates.appendNodeContents('#phase-container', html, js);\n\n                    $('.phase-collapse-control').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.collapsePhase(e); });\n\n                    $('#add-phase').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.addPhase(e); });\n\n                    $('.add-phase-cycle').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.addCycle(e); });\n\n                    phasesave.rebind_inputs();\n                    RoadmapConfig.prototype.bindConfigSave();\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addCycle = function(event) {\n            console.log('RoadmapConfig.prototype.addCycle');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var phaseContainer = thisnode.closest('.phase-container');\n            var cycleContainer = phaseContainer.children('.phase-cycles-container');\n\n            var nextCycleIndex = cycleContainer.children('.cycle-wrapper').length;\n            var totalCycles = $('.phase-cycles-container > .cycle-wrapper').length;\n            var newCycle = {id: totalCycles+1, index: nextCycleIndex, number: nextCycleIndex+1};\n\n            templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then(function(html, js) {\n                    templates.appendNodeContents(cycleContainer, html, js);\n\n                    $('.cycle-collapse-control').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.collapseCycle(e); });\n\n                    $('.add-cycle-step').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.addStep(e); });\n\n                    learningobjectives.refresh_checklists();\n                    cyclesave.rebind_inputs();\n                    phasesave.rebind_inputs();\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.addStep = function(event) {\n            console.log('RoadmapConfig.prototype.addStep');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleContainer = thisnode.closest('.cycle-container');\n            var stepsContainer = cycleContainer.children('.cycle-steps-container');\n\n            var nextStepIndex = stepsContainer.children('.step-wrapper').length;\n            var totalSteps = $('.step-wrapper').length;\n            var dtpdata = JSON.parse($('input[name=\"datetimepickerdata\"]').val());\n            var newStep = {\n                id: totalSteps+1,\n                index: nextStepIndex,\n                number: nextStepIndex+1,\n                days: dtpdata.days,\n                months: dtpdata.months,\n                years: dtpdata.years,\n                hours: dtpdata.hours,\n                minutes: dtpdata.minutes,\n                stepicon: 'icon-10',\n            };\n\n            templates.render('mod_roadmap/configuration_step', newStep)\n                .then(function(html, js) {\n                    templates.appendNodeContents(stepsContainer, html, js);\n\n                    $('.step-collapse-control').unbind('click')\n                        .click(function(e) { RoadmapConfig.prototype.collapseStep(e); });\n\n                    stepiconselect.rebind_buttons();\n                    stepactivityselect.rebind_buttons();\n                    stepsave.rebind_inputs();\n                    cyclesave.rebind_inputs();\n\n                }).fail(notification.exception);\n        };\n\n        RoadmapConfig.prototype.collapsePhase = function(event) {\n            console.log('RoadmapConfig.prototype.collapsePhase');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var phaseWrapper = thisnode.closest('.phase-wrapper');\n            var metadata = phaseWrapper.children('.phase-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseCycle = function(event) {\n            console.log('RoadmapConfig.prototype.collapseCycle');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.cycle-wrapper');\n            var metadata = cycleWrapper.children('.cycle-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        RoadmapConfig.prototype.collapseStep = function(event) {\n            console.log('RoadmapConfig.prototype.collapseStep');\n            event.preventDefault();\n            event.stopPropagation();\n            var thisnode = $(event.currentTarget);\n            var cycleWrapper = thisnode.closest('.step-wrapper');\n            var metadata = cycleWrapper.children('.step-container');\n            ec.expandCollapse(metadata, thisnode);\n        };\n\n        return {\n\n            /**\n             * Main initialisation.\n             *\n             * @param {String} inputSelector The hidden input field selector.\n             * @return {LearningObjectivesConfig} A new instance of PhasesConfig.\n             * @method init\n             */\n            init: function(inputSelector, inputConfig) {\n                return new RoadmapConfig(inputSelector, inputConfig);\n            }\n        };\n    });\n"],"file":"roadmap_config.min.js"}