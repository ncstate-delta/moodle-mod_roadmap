{"version":3,"file":"roadmap_config.min.js","sources":["../src/roadmap_config.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap.\n *\n * @module     mod_roadmap/roadmapconfig\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'core/notification',\n    'core/templates',\n    'core/str',\n    'mod_roadmap/expand_contract',\n    'mod_roadmap/learningobjectivesconfig',\n    'mod_roadmap/step_icon_select',\n    'mod_roadmap/step_activity_select',\n    'mod_roadmap/step_save',\n    'mod_roadmap/cycle_save',\n    'mod_roadmap/phase_save',\n    'mod_roadmap/repository',\n    'core/modal_delete_cancel',\n    'core/modal_events'\n], (\n    $,\n    notification,\n    templates,\n    getString,\n    expandContract,\n    learningObjectives,\n    stepIconSelect,\n    stepActivitySelect,\n    stepSave,\n    cycleSave,\n    phaseSave,\n    roadmapRepo,\n    ModalDeleteCancel,\n    ModalEvents\n) => {\n\n    const showDeleteConfirmModal = (message, title = getString('confirmdelete', 'mod_roadmap')) => {\n        return ModalDeleteCancel.create({\n            title,\n            body: message\n        }).then(modal => {\n            return new Promise(resolve => {\n                modal.show();\n                modal.getRoot().on(ModalEvents.delete, () => {\n                    resolve(true);\n                    modal.hide();\n                });\n                modal.getRoot().on(ModalEvents.cancel, () => {\n                    resolve(false);\n                    modal.hide();\n                });\n                modal.getRoot().on(ModalEvents.hidden, () => {\n                    modal.destroy();\n                });\n            });\n        });\n    };\n\n    const getMaxValue = dataType => {\n        const ids = [];\n        $(`.${dataType}-wrapper`).each(function() {\n            const id = parseInt($(this).data(`${dataType}id`), 10);\n            if (!isNaN(id)) {\n                ids.push(id);\n            }\n        });\n        return ids.length ? Math.max(...ids) : 0;\n    };\n\n    const moveWrapper = (wrapper, direction) => {\n        if (direction === 'up') {\n            const prev = wrapper.prev();\n            if (prev.length) {\n                wrapper.insertBefore(prev);\n            }\n        } else if (direction === 'down') {\n            const next = wrapper.next();\n            if (next.length) {\n                wrapper.insertAfter(next);\n            }\n        }\n    };\n\n    let colorPatternCache = {};\n\n    class RoadmapConfig {\n        constructor(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n            this.initForm();\n        }\n\n        initForm() {\n            let inputConfigVal = this.configContainer.val();\n            if (!inputConfigVal) {\n                inputConfigVal = JSON.stringify({phases: []});\n                this.configContainer.val(inputConfigVal);\n            }\n            let config;\n            try {\n                config = JSON.parse(inputConfigVal);\n            } catch (e) {\n                notification.exception(e);\n                config = {phases: []};\n            }\n\n            config.phases.forEach(phase => {\n                phase.configuration = JSON.stringify(phase);\n                (phase.cycles || []).forEach(cycle => {\n                    cycle.configuration = JSON.stringify(cycle);\n                    (cycle.steps || []).forEach(step => {\n                        step.configuration = JSON.stringify(step);\n                    });\n                });\n            });\n\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then((html, js) => {\n                    templates.prependNodeContents(this.inputSelector, html, js);\n\n                    this.bindExpandCollapseControls();\n\n                    $('#roadmapconfiguration')\n                        .off('click', 'a[data-action]')\n                        .on('click', 'a[data-action]', e => this.clickHandler(e));\n\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n\n                    learningObjectives.refreshChecklists();\n                    stepIconSelect.rebindButtons();\n                    stepActivitySelect.rebindButtons();\n                    stepSave.rebindInputs();\n                    cycleSave.rebindInputs();\n                    phaseSave.rebindInputs();\n                    this.bindConfigSave();\n\n                    require(['theme_boost/loader']);\n                    return null;\n                })\n                .catch(notification.exception);\n\n            $('select[name=\"phasecolorpattern\"]').off('change').on('change', e => {\n                this.phaseColorChange($(e.target));\n            });\n        }\n\n        clickHandler(event) {\n            const node = $(event.currentTarget);\n            const action = node.data('action');\n            const actionMap = {\n                'collapse_all_phases': () => this.collapsePhases(),\n                'expand_all_phases': () => this.expandPhases(),\n                'collapse_all_cycles': () =>\n                    this.collapseCycles(\n                        node.closest('.phase-wrapper')\n                            .find('.phase-cycles-container')\n                            .first()\n                    ),\n                'expand_all_cycles': () =>\n                    this.expandCycles(\n                        node.closest('.phase-wrapper')\n                            .find('.phase-cycles-container')\n                            .first()\n                    ),\n                'collapse_all_steps': () =>\n                    this.collapseSteps(\n                        node.parent('.step-container-controls')\n                            .next('.cycle-steps-container')\n                    ),\n                'expand_all_steps': () =>\n                    this.expandSteps(\n                        node.parent('.step-container-controls')\n                            .next('.cycle-steps-container')\n                    ),\n                'phase_collapse_control': () => this.collapsePhase(node),\n                'cycle_collapse_control': () => this.collapseCycle(node),\n                'step_collapse_control': () => this.collapseStep(node),\n                'phase_delete_control': () => this.deletePhase(node),\n                'cycle_delete_control': () => this.deleteCycle(node),\n                'step_delete_control': () => this.deleteStep(node),\n                'add_phase': () => this.addPhase(),\n                'phase_up_control': () => this.upPhase(node),\n                'phase_down_control': () => this.downPhase(node),\n                'add_phase_cycle': () => this.addCycle(node),\n                'cycle_up_control': () => this.upCycle(node),\n                'cycle_down_control': () => this.downCycle(node),\n                'add_cycle_step': () => this.addStep(node),\n                'step_up_control': () => this.upStep(node),\n                'step_down_control': () => this.downStep(node)\n            };\n            if (actionMap[action]) {\n                return actionMap[action]();\n            }\n            return undefined;\n        }\n\n        phaseColorChange(node) {\n            const colorId = node.val();\n            if (colorPatternCache[colorId]) {\n                this.applyColorSet(colorPatternCache[colorId]);\n                return;\n            }\n            roadmapRepo.fetchColorPattern(colorId)\n                .then(colors => {\n                    colorPatternCache[colorId] = colors;\n                    this.applyColorSet(colors);\n                    return colors;\n                })\n                .catch(notification.exception);\n        }\n\n        applyColorSet(colors) {\n            $('.phase-color-display').remove();\n            const colorTable = $('<div>').addClass('phase-color-display');\n            colors.forEach(color => {\n                colorTable.append(`<div class=\"color\" style=\"background-color:${color}\"></div>`);\n            });\n            $('select[name=\"phasecolorpattern\"]').parent().append(colorTable);\n\n            $('#roadmapconfiguration #phase-container > .phase-wrapper > div.row').each(function(i) {\n                const numColors = colors.length;\n                const idxColor = i % numColors;\n                $(this).css('border-bottom', `solid 1px ${colors[idxColor]}`);\n            });\n        }\n\n        bindConfigSave() {\n            $('input.phase-configuration').off('change').on('change', () => this.configSave());\n        }\n\n        configSave() {\n            const phaseContainer = $('#phase-container');\n            const roadmapData = [];\n            let index = 0;\n            phaseContainer.find('.phase-wrapper .phase-configuration').each(function() {\n                const phaseData = $(this).val() || '{}';\n                const phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index++;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({\n                phases: roadmapData,\n                phaseDeletes: $('#phase-deletes').val(),\n                cycleDeletes: $('#cycle-deletes').val(),\n                stepDeletes: $('#step-deletes').val()\n            }));\n        }\n\n        addPhase() {\n            const roadmapConfigInput = $('input[name=\"roadmapconfiguration\"]');\n            const config = JSON.parse(roadmapConfigInput.val());\n            const nextIndex = config.phases.length;\n            const maxPhaseId = getMaxValue('phase');\n            const newPhase = {\n                id: maxPhaseId + 1,\n                index: nextIndex,\n                number: nextIndex + 1,\n                title: `${getString('phase', 'mod_roadmap')} ${nextIndex + 1}`,\n                subtitle: `${getString('subtitle', 'mod_roadmap')} ${nextIndex + 1}`\n            };\n            config.phases.push(newPhase);\n            roadmapConfigInput.val(JSON.stringify(config));\n            return templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then((html, js) => {\n                    templates.appendNodeContents('#phase-container', html, js);\n                    phaseSave.rebindInputs();\n                    this.bindConfigSave();\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n                    return null;\n                })\n                .catch(notification.exception);\n        }\n\n        addCycle(node) {\n            const phaseContainer = node.closest('.phase-container');\n            const cycleContainer = phaseContainer.children('.phase-cycles-container');\n            const nextCycleIndex = cycleContainer.children('.cycle-wrapper').length;\n            const maxCycleId = getMaxValue('cycle');\n            const newCycle = {\n                id: maxCycleId + 1,\n                index: nextCycleIndex,\n                number: nextCycleIndex + 1,\n                title: `${getString('cycle', 'mod_roadmap')} ${nextCycleIndex + 1}`,\n                subtitle: `${getString('subtitle', 'mod_roadmap')} ${nextCycleIndex + 1}`\n            };\n            return templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then((html, js) => {\n                    templates.appendNodeContents(cycleContainer, html, js);\n                    learningObjectives.refreshChecklists();\n                    cycleSave.rebindInputs();\n                    phaseSave.rebindInputs();\n                    return null;\n                })\n                .catch(notification.exception);\n        }\n\n        addStep(node) {\n            const cycleContainer = node.closest('.cycle-container');\n            const stepsContainer = cycleContainer.children('.cycle-steps-container');\n            const nextStepIndex = stepsContainer.children('.step-wrapper').length;\n            const maxStepId = getMaxValue('step');\n            const iconUrl = $('input[name=\"icon_url\"]').val();\n\n            const newStep = {\n                id: maxStepId + 1,\n                index: nextStepIndex,\n                number: nextStepIndex + 1,\n                stepicon: 'icon-10',\n                iconurl: `${iconUrl}?name=icon-10&percent=100&flags=n`\n            };\n            return templates.render('mod_roadmap/configuration_step', newStep)\n                .then((html, js) => {\n                    templates.appendNodeContents(stepsContainer, html, js);\n                    stepIconSelect.rebindButtons();\n                    stepActivitySelect.rebindButtons();\n                    stepSave.rebindInputs();\n                    cycleSave.rebindInputs();\n                    return null;\n                })\n                .catch(notification.exception);\n        }\n\n        bindExpandCollapseControls() {\n            $('.expand-collapse-controls .collapse_everything').off('click').on('click', e => {\n                e.preventDefault();\n                this.collapseEverything();\n            });\n            $('.expand-collapse-controls .expand_everything').off('click').on('click', e => {\n                e.preventDefault();\n                this.expandEverything();\n            });\n        }\n\n        expandPhases() {\n            this.expandChildrenClass($('#roadmapconfiguration'), 'phase');\n        }\n        expandCycles(node) {\n            this.expandChildrenClass(node, 'cycle');\n        }\n        expandSteps(node) {\n            this.expandChildrenClass(node, 'step');\n        }\n        collapsePhases() {\n            const node = $('#roadmapconfiguration');\n            this.collapseCycles(node);\n            this.collapseChildrenClass(node, 'phase');\n        }\n        collapseCycles(node) {\n            this.collapseSteps(node);\n            this.collapseChildrenClass(node, 'cycle');\n        }\n        collapseSteps(node) {\n            this.collapseChildrenClass(node, 'step');\n        }\n        expandChildrenClass(parent, className) {\n            parent.find(`a[data-action=\"${className}_collapse_control\"]`).each(function() {\n                const wrapper = $(this).closest(`.${className}-wrapper`);\n                const container = wrapper.children(`.${className}-container`);\n                if (container.hasClass('hide')) {\n                    $(this).click();\n                }\n            });\n        }\n        collapseChildrenClass(parent, className) {\n            parent.find(`a[data-action=\"${className}_collapse_control\"]`).each(function() {\n                const wrapper = $(this).closest(`.${className}-wrapper`);\n                const container = wrapper.children(`.${className}-container`);\n                if (container.hasClass('visible')) {\n                    $(this).click();\n                }\n            });\n        }\n\n        collapsePhase(node) {\n            const wrapper = node.closest('.phase-wrapper');\n            const container = wrapper.children('.phase-container');\n            expandContract.expandCollapse(container, node);\n        }\n        collapseCycle(node) {\n            const wrapper = node.closest('.cycle-wrapper');\n            const container = wrapper.children('.cycle-container');\n            expandContract.expandCollapse(container, node);\n        }\n        collapseStep(node) {\n            const wrapper = node.closest('.step-wrapper');\n            const container = wrapper.children('.step-container');\n            expandContract.expandCollapse(container, node);\n        }\n\n        deletePhase(node) {\n            return showDeleteConfirmModal(\n                getString('confirmdeletephase', 'mod_roadmap'),\n                getString('confirmdelete', 'mod_roadmap')\n            ).then(confirmed => {\n                if (confirmed) {\n                    const wrapper = node.closest('.phase-wrapper');\n                    if (!wrapper.length) {\n                        return null;\n                    }\n                    const phaseId = wrapper.data('phaseid');\n                    const phaseDeletes = $('#phase-deletes');\n                    phaseDeletes.val(phaseDeletes.val() + phaseId + ',');\n                    wrapper.remove();\n                    this.configSave();\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n                }\n                return null;\n            });\n        }\n\n        deleteCycle(node) {\n            return showDeleteConfirmModal(\n                getString('confirmdeletecycle', 'mod_roadmap'),\n                getString('confirmdelete', 'mod_roadmap')\n            ).then(confirmed => {\n                if (confirmed) {\n                    const wrapper = node.closest('.cycle-wrapper');\n                    if (!wrapper.length) {\n                        return null;\n                    }\n                    const phaseContainer = node.closest('.phase-container');\n                    const cycleId = wrapper.data('cycleid');\n                    const cycleDeletes = $('#cycle-deletes');\n                    cycleDeletes.val(cycleDeletes.val() + cycleId + ',');\n                    wrapper.remove();\n                    phaseContainer.find('.phase-title').triggerHandler('change');\n                }\n                return null;\n            });\n        }\n\n        deleteStep(node) {\n            return showDeleteConfirmModal(\n                getString('confirmdeletestep', 'mod_roadmap'),\n                getString('confirmdelete', 'mod_roadmap')\n            ).then(confirmed => {\n                if (confirmed) {\n                    const wrapper = node.closest('.step-wrapper');\n                    if (!wrapper.length) {\n                        return null;\n                    }\n                    const cycleContainer = node.closest('.cycle-container');\n                    const stepId = wrapper.data('stepid');\n                    const stepDeletes = $('#step-deletes');\n                    stepDeletes.val(stepDeletes.val() + stepId + ',');\n                    wrapper.remove();\n                    cycleContainer.find('.cycle-title').triggerHandler('change');\n                }\n                return null;\n            });\n        }\n\n        upPhase(node) {\n            const wrapper = node.closest('.phase-wrapper');\n            moveWrapper(wrapper, 'up');\n            this.configSave();\n            this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n        }\n        downPhase(node) {\n            const wrapper = node.closest('.phase-wrapper');\n            moveWrapper(wrapper, 'down');\n            this.configSave();\n            this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n        }\n        upCycle(node) {\n            const wrapper = node.closest('.cycle-wrapper');\n            const phaseContainer = node.closest('.phase-container');\n            moveWrapper(wrapper, 'up');\n            phaseContainer.find('.phase-title').triggerHandler('change');\n        }\n        downCycle(node) {\n            const wrapper = node.closest('.cycle-wrapper');\n            const phaseContainer = node.closest('.phase-container');\n            moveWrapper(wrapper, 'down');\n            phaseContainer.find('.phase-title').triggerHandler('change');\n        }\n        upStep(node) {\n            const wrapper = node.closest('.step-wrapper');\n            const cycleContainer = node.closest('.cycle-container');\n            moveWrapper(wrapper, 'up');\n            cycleContainer.find('.cycle-title').triggerHandler('change');\n        }\n        downStep(node) {\n            const wrapper = node.closest('.step-wrapper');\n            const cycleContainer = node.closest('.cycle-container');\n            moveWrapper(wrapper, 'down');\n            cycleContainer.find('.cycle-title').triggerHandler('change');\n        }\n\n        expandEverything() {\n            this.expandPhases();\n        }\n        collapseEverything() {\n            this.collapsePhases();\n        }\n    }\n\n    return {\n        init: (inputSelector, inputConfig) => new RoadmapConfig(inputSelector, inputConfig)\n    };\n});"],"names":["define","$","notification","templates","getString","expandContract","learningObjectives","stepIconSelect","stepActivitySelect","stepSave","cycleSave","phaseSave","roadmapRepo","ModalDeleteCancel","ModalEvents","showDeleteConfirmModal","message","title","create","body","then","modal","Promise","resolve","show","getRoot","on","delete","hide","cancel","hidden","destroy","getMaxValue","dataType","ids","each","id","parseInt","this","data","isNaN","push","length","Math","max","moveWrapper","wrapper","direction","prev","insertBefore","next","insertAfter","colorPatternCache","RoadmapConfig","constructor","inputSelector","inputConfig","configContainer","initForm","config","inputConfigVal","val","JSON","stringify","phases","parse","e","exception","forEach","phase","configuration","cycles","cycle","steps","step","render","html","js","prependNodeContents","bindExpandCollapseControls","off","clickHandler","phaseColorChange","refreshChecklists","rebindButtons","rebindInputs","bindConfigSave","require","catch","target","event","node","currentTarget","action","actionMap","collapsePhases","expandPhases","collapseCycles","closest","find","first","expandCycles","collapseSteps","parent","expandSteps","collapsePhase","collapseCycle","collapseStep","deletePhase","deleteCycle","deleteStep","addPhase","upPhase","downPhase","addCycle","upCycle","downCycle","addStep","upStep","downStep","colorId","applyColorSet","fetchColorPattern","colors","remove","colorTable","addClass","color","append","i","idxColor","css","configSave","phaseContainer","roadmapData","index","phaseData","phaseDataObj","phaseDeletes","cycleDeletes","stepDeletes","roadmapConfigInput","nextIndex","newPhase","number","subtitle","appendNodeContents","cycleContainer","children","nextCycleIndex","newCycle","stepsContainer","nextStepIndex","maxStepId","iconUrl","newStep","stepicon","iconurl","preventDefault","collapseEverything","expandEverything","expandChildrenClass","collapseChildrenClass","className","hasClass","click","container","expandCollapse","confirmed","phaseId","cycleId","triggerHandler","stepId","init"],"mappings":"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"}