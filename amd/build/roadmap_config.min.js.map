{"version":3,"file":"roadmap_config.min.js","sources":["../src/roadmap_config.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the configuration of the roadmap.\n *\n * @module     mod_roadmap/roadmapconfig\n * @copyright  2021 Steve Bader <smbader@ncsu.edu>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'core/notification',\n    'core/templates',\n    'mod_roadmap/expand_contract',\n    'mod_roadmap/learningobjectivesconfig',\n    'mod_roadmap/step_icon_select',\n    'mod_roadmap/step_activity_select',\n    'mod_roadmap/step_save',\n    'mod_roadmap/cycle_save',\n    'mod_roadmap/phase_save',\n    'mod_roadmap/repository',\n    'core/modal_delete_cancel',\n    'core/modal_events'\n], (\n    $,\n    notification,\n    templates,\n    expandContract,\n    learningObjectives,\n    stepIconSelect,\n    stepActivitySelect,\n    stepSave,\n    cycleSave,\n    phaseSave,\n    roadmapRepo,\n    ModalDeleteCancel,\n    ModalEvents\n) => {\n\n    const showDeleteConfirmModal = (message, title = 'Confirm delete') => {\n        return ModalDeleteCancel.create({\n            title,\n            body: message\n        }).then(modal => {\n            return new Promise(resolve => {\n                modal.show();\n                modal.getRoot().on(ModalEvents.delete, () => {\n                    resolve(true);\n                    modal.hide();\n                });\n                modal.getRoot().on(ModalEvents.cancel, () => {\n                    resolve(false);\n                    modal.hide();\n                });\n                modal.getRoot().on(ModalEvents.hidden, () => {\n                    modal.destroy();\n                });\n            });\n        });\n    };\n\n    const getMaxValue = dataType => {\n        const ids = [];\n        $(`.${dataType}-wrapper`).each(function() {\n            const id = parseInt($(this).data(`${dataType}id`), 10);\n            if (!isNaN(id)) {\n                ids.push(id);\n            }\n        });\n        return ids.length ? Math.max(...ids) : 0;\n    };\n\n    const moveWrapper = ($wrapper, direction) => {\n        if (direction === 'up') {\n            const $prev = $wrapper.prev();\n            if ($prev.length) {\n                $wrapper.insertBefore($prev);\n            }\n        } else if (direction === 'down') {\n            const $next = $wrapper.next();\n            if ($next.length) {\n                $wrapper.insertAfter($next);\n            }\n        }\n    };\n\n    let colorPatternCache = {};\n\n    class RoadmapConfig {\n        constructor(inputSelector, inputConfig) {\n            this.inputSelector = inputSelector;\n            this.configContainer = $(inputConfig);\n            this.initForm();\n        }\n\n        initForm() {\n            let inputConfigVal = this.configContainer.val();\n            if (!inputConfigVal) {\n                inputConfigVal = JSON.stringify({phases: []});\n                this.configContainer.val(inputConfigVal);\n            }\n            let config;\n            try {\n                config = JSON.parse(inputConfigVal);\n            } catch (e) {\n                notification.exception(e);\n                config = {phases: []};\n            }\n\n            config.phases.forEach(phase => {\n                phase.configuration = JSON.stringify(phase);\n                (phase.cycles || []).forEach(cycle => {\n                    cycle.configuration = JSON.stringify(cycle);\n                    (cycle.steps || []).forEach(step => {\n                        step.configuration = JSON.stringify(step);\n                    });\n                });\n            });\n\n            templates.render('mod_roadmap/configuration_phases', config)\n                .then((html, js) => {\n                    templates.prependNodeContents(this.inputSelector, html, js);\n\n                    this.bindExpandCollapseControls();\n\n                    $('#roadmapconfiguration')\n                        .off('click', 'a[data-action]')\n                        .on('click', 'a[data-action]', e => this.clickHandler(e));\n\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n\n                    learningObjectives.refreshChecklists();\n                    stepIconSelect.rebindButtons();\n                    stepActivitySelect.rebindButtons();\n                    stepSave.rebindInputs();\n                    cycleSave.rebindInputs();\n                    phaseSave.rebindInputs();\n                    this.bindConfigSave();\n\n                    require(['theme_boost/loader']);\n                    return null;\n                })\n                .catch(notification.exception);\n\n            $('select[name=\"phasecolorpattern\"]').off('change').on('change', e => {\n                this.phaseColorChange($(e.target));\n            });\n        }\n\n        clickHandler(event) {\n            const $node = $(event.currentTarget);\n            const action = $node.data('action');\n            const actionMap = {\n                'collapse_all_phases': () => this.collapsePhases(),\n                'expand_all_phases': () => this.expandPhases(),\n                'collapse_all_cycles': () =>\n                    this.collapseCycles(\n                        $node.closest('.phase-wrapper')\n                            .find('.phase-cycles-container')\n                            .first()\n                    ),\n                'expand_all_cycles': () =>\n                    this.expandCycles(\n                        $node.closest('.phase-wrapper')\n                            .find('.phase-cycles-container')\n                            .first()\n                    ),\n                'collapse_all_steps': () =>\n                    this.collapseSteps(\n                        $node.parent('.step-container-controls')\n                            .next('.cycle-steps-container')\n                    ),\n                'expand_all_steps': () =>\n                    this.expandSteps(\n                        $node.parent('.step-container-controls')\n                            .next('.cycle-steps-container')\n                    ),\n                'phase_collapse_control': () => this.collapsePhase($node),\n                'cycle_collapse_control': () => this.collapseCycle($node),\n                'step_collapse_control': () => this.collapseStep($node),\n                'phase_delete_control': () => this.deletePhase($node),\n                'cycle_delete_control': () => this.deleteCycle($node),\n                'step_delete_control': () => this.deleteStep($node),\n                'add_phase': () => this.addPhase(),\n                'phase_up_control': () => this.upPhase($node),\n                'phase_down_control': () => this.downPhase($node),\n                'add_phase_cycle': () => this.addCycle($node),\n                'cycle_up_control': () => this.upCycle($node),\n                'cycle_down_control': () => this.downCycle($node),\n                'add_cycle_step': () => this.addStep($node),\n                'step_up_control': () => this.upStep($node),\n                'step_down_control': () => this.downStep($node)\n            };\n            if (actionMap[action]) {\n                return actionMap[action]();\n            }\n            return undefined;\n        }\n\n        phaseColorChange($node) {\n            const colorId = $node.val();\n            if (colorPatternCache[colorId]) {\n                this.applyColorSet(colorPatternCache[colorId]);\n                return;\n            }\n            roadmapRepo.fetchColorPattern(colorId)\n                .then(colors => {\n                    colorPatternCache[colorId] = colors;\n                    this.applyColorSet(colors);\n                    return colors;\n                })\n                .catch(notification.exception);\n        }\n\n        applyColorSet(colors) {\n            $('.phase-color-display').remove();\n            const $colorTable = $('<div>').addClass('phase-color-display');\n            colors.forEach(color => {\n                $colorTable.append(`<div class=\"color\" style=\"background-color:${color}\"></div>`);\n            });\n            $('select[name=\"phasecolorpattern\"]').parent().append($colorTable);\n\n            $('#roadmapconfiguration #phase-container > .phase-wrapper > div.row').each(function(i) {\n                const numColors = colors.length;\n                const idxColor = i % numColors;\n                $(this).css('border-bottom', `solid 1px ${colors[idxColor]}`);\n            });\n        }\n\n        bindConfigSave() {\n            $('input.phase-configuration').off('change').on('change', () => this.configSave());\n        }\n\n        configSave() {\n            const $phaseContainer = $('#phase-container');\n            const roadmapData = [];\n            let index = 0;\n            $phaseContainer.find('.phase-wrapper .phase-configuration').each(function() {\n                const phaseData = $(this).val() || '{}';\n                const phaseDataObj = JSON.parse(phaseData);\n                phaseDataObj.index = index++;\n                roadmapData.push(phaseDataObj);\n            });\n            $('input[name=\"roadmapconfiguration\"]').val(JSON.stringify({\n                phases: roadmapData,\n                phaseDeletes: $('#phase-deletes').val(),\n                cycleDeletes: $('#cycle-deletes').val(),\n                stepDeletes: $('#step-deletes').val()\n            }));\n        }\n\n        addPhase() {\n            const $roadmapConfigInput = $('input[name=\"roadmapconfiguration\"]');\n            const config = JSON.parse($roadmapConfigInput.val());\n            const nextIndex = config.phases.length;\n            const maxPhaseId = getMaxValue('phase');\n            const newPhase = {\n                id: maxPhaseId + 1,\n                index: nextIndex,\n                number: nextIndex + 1,\n                title: `Phase ${nextIndex + 1}`,\n                subtitle: `Subtitle ${nextIndex + 1}`\n            };\n            config.phases.push(newPhase);\n            $roadmapConfigInput.val(JSON.stringify(config));\n            return templates.render('mod_roadmap/configuration_phase', newPhase)\n                .then((html, js) => {\n                    templates.appendNodeContents('#phase-container', html, js);\n                    phaseSave.rebindInputs();\n                    this.bindConfigSave();\n                    this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n                    return null;\n                })\n                .catch(notification.exception);\n        }\n\n        addCycle($node) {\n            const $phaseContainer = $node.closest('.phase-container');\n            const $cycleContainer = $phaseContainer.children('.phase-cycles-container');\n            const nextCycleIndex = $cycleContainer.children('.cycle-wrapper').length;\n            const maxCycleId = getMaxValue('cycle');\n            const newCycle = {\n                id: maxCycleId + 1,\n                index: nextCycleIndex,\n                number: nextCycleIndex + 1,\n                title: `Cycle ${nextCycleIndex + 1}`,\n                subtitle: `Subtitle ${nextCycleIndex + 1}`\n            };\n            return templates.render('mod_roadmap/configuration_cycle', newCycle)\n                .then((html, js) => {\n                    templates.appendNodeContents($cycleContainer, html, js);\n                    learningObjectives.refreshChecklists();\n                    cycleSave.rebindInputs();\n                    phaseSave.rebindInputs();\n                    return null;\n                })\n                .catch(notification.exception);\n        }\n\n        addStep($node) {\n            const $cycleContainer = $node.closest('.cycle-container');\n            const $stepsContainer = $cycleContainer.children('.cycle-steps-container');\n            const nextStepIndex = $stepsContainer.children('.step-wrapper').length;\n            const maxStepId = getMaxValue('step');\n            const iconUrl = $('input[name=\"icon_url\"]').val();\n\n            const newStep = {\n                id: maxStepId + 1,\n                index: nextStepIndex,\n                number: nextStepIndex + 1,\n                stepicon: 'icon-10',\n                iconurl: `${iconUrl}?name=icon-10&percent=100&flags=n`\n            };\n            return templates.render('mod_roadmap/configuration_step', newStep)\n                .then((html, js) => {\n                    templates.appendNodeContents($stepsContainer, html, js);\n                    stepIconSelect.rebindButtons();\n                    stepActivitySelect.rebindButtons();\n                    stepSave.rebindInputs();\n                    cycleSave.rebindInputs();\n                    return null;\n                })\n                .catch(notification.exception);\n        }\n\n        bindExpandCollapseControls() {\n            $('.expand-collapse-controls .collapse_everything').off('click').on('click', e => {\n                e.preventDefault();\n                this.collapseEverything();\n            });\n            $('.expand-collapse-controls .expand_everything').off('click').on('click', e => {\n                e.preventDefault();\n                this.expandEverything();\n            });\n        }\n\n        expandPhases() {\n            this.expandChildrenClass($('#roadmapconfiguration'), 'phase');\n        }\n        expandCycles(node) {\n            this.expandChildrenClass(node, 'cycle');\n        }\n        expandSteps(node) {\n            this.expandChildrenClass(node, 'step');\n        }\n        collapsePhases() {\n            const node = $('#roadmapconfiguration');\n            this.collapseCycles(node);\n            this.collapseChildrenClass(node, 'phase');\n        }\n        collapseCycles(node) {\n            this.collapseSteps(node);\n            this.collapseChildrenClass(node, 'cycle');\n        }\n        collapseSteps(node) {\n            this.collapseChildrenClass(node, 'step');\n        }\n        expandChildrenClass($parent, className) {\n            $parent.find(`a[data-action=\"${className}_collapse_control\"]`).each(function() {\n                const $wrapper = $(this).closest(`.${className}-wrapper`);\n                const $container = $wrapper.children(`.${className}-container`);\n                if ($container.hasClass('hide')) {\n                    $(this).click();\n                }\n            });\n        }\n        collapseChildrenClass($parent, className) {\n            $parent.find(`a[data-action=\"${className}_collapse_control\"]`).each(function() {\n                const $wrapper = $(this).closest(`.${className}-wrapper`);\n                const $container = $wrapper.children(`.${className}-container`);\n                if ($container.hasClass('visible')) {\n                    $(this).click();\n                }\n            });\n        }\n\n        collapsePhase($node) {\n            const $wrapper = $node.closest('.phase-wrapper');\n            const $container = $wrapper.children('.phase-container');\n            expandContract.expandCollapse($container, $node);\n        }\n        collapseCycle($node) {\n            const $wrapper = $node.closest('.cycle-wrapper');\n            const $container = $wrapper.children('.cycle-container');\n            expandContract.expandCollapse($container, $node);\n        }\n        collapseStep($node) {\n            const $wrapper = $node.closest('.step-wrapper');\n            const $container = $wrapper.children('.step-container');\n            expandContract.expandCollapse($container, $node);\n        }\n\n        deletePhase($node) {\n            return showDeleteConfirmModal('Are you sure you want to delete this Phase?', 'Confirm delete')\n                .then(confirmed => {\n                    if (confirmed) {\n                        const $wrapper = $node.closest('.phase-wrapper');\n                        if (!$wrapper.length) {\n                            return null;\n                        }\n                        const phaseId = $wrapper.data('phaseid');\n                        const $phaseDeletes = $('#phase-deletes');\n                        $phaseDeletes.val($phaseDeletes.val() + phaseId + ',');\n                        $wrapper.remove();\n                        this.configSave();\n                        this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n                    }\n                    return null;\n                });\n        }\n\n        deleteCycle($node) {\n            return showDeleteConfirmModal('Are you sure you want to delete this Cycle?', 'Confirm delete')\n                .then(confirmed => {\n                    if (confirmed) {\n                        const $wrapper = $node.closest('.cycle-wrapper');\n                        if (!$wrapper.length) {\n                            return null;\n                        }\n                        const $phaseContainer = $node.closest('.phase-container');\n                        const cycleId = $wrapper.data('cycleid');\n                        const $cycleDeletes = $('#cycle-deletes');\n                        $cycleDeletes.val($cycleDeletes.val() + cycleId + ',');\n                        $wrapper.remove();\n                        $phaseContainer.find('.phase-title').triggerHandler('change');\n                    }\n                    return null;\n                });\n        }\n\n        deleteStep($node) {\n            return showDeleteConfirmModal('Are you sure you want to delete this Step?', 'Confirm delete')\n                .then(confirmed => {\n                    if (confirmed) {\n                        const $wrapper = $node.closest('.step-wrapper');\n                        if (!$wrapper.length) {\n                            return null;\n                        }\n                        const $cycleContainer = $node.closest('.cycle-container');\n                        const stepId = $wrapper.data('stepid');\n                        const $stepDeletes = $('#step-deletes');\n                        $stepDeletes.val($stepDeletes.val() + stepId + ',');\n                        $wrapper.remove();\n                        $cycleContainer.find('.cycle-title').triggerHandler('change');\n                    }\n                    return null;\n                });\n        }\n\n        upPhase($node) {\n            const $wrapper = $node.closest('.phase-wrapper');\n            moveWrapper($wrapper, 'up');\n            this.configSave();\n            this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n        }\n        downPhase($node) {\n            const $wrapper = $node.closest('.phase-wrapper');\n            moveWrapper($wrapper, 'down');\n            this.configSave();\n            this.phaseColorChange($('select[name=\"phasecolorpattern\"]'));\n        }\n        upCycle($node) {\n            const $wrapper = $node.closest('.cycle-wrapper');\n            const $phaseContainer = $node.closest('.phase-container');\n            moveWrapper($wrapper, 'up');\n            $phaseContainer.find('.phase-title').triggerHandler('change');\n        }\n        downCycle($node) {\n            const $wrapper = $node.closest('.cycle-wrapper');\n            const $phaseContainer = $node.closest('.phase-container');\n            moveWrapper($wrapper, 'down');\n            $phaseContainer.find('.phase-title').triggerHandler('change');\n        }\n        upStep($node) {\n            const $wrapper = $node.closest('.step-wrapper');\n            const $cycleContainer = $node.closest('.cycle-container');\n            moveWrapper($wrapper, 'up');\n            $cycleContainer.find('.cycle-title').triggerHandler('change');\n        }\n        downStep($node) {\n            const $wrapper = $node.closest('.step-wrapper');\n            const $cycleContainer = $node.closest('.cycle-container');\n            moveWrapper($wrapper, 'down');\n            $cycleContainer.find('.cycle-title').triggerHandler('change');\n        }\n\n        expandEverything() {\n            this.expandPhases();\n        }\n        collapseEverything() {\n            this.collapsePhases();\n        }\n    }\n\n    return {\n        init: (inputSelector, inputConfig) => new RoadmapConfig(inputSelector, inputConfig)\n    };\n});"],"names":["define","$","notification","templates","expandContract","learningObjectives","stepIconSelect","stepActivitySelect","stepSave","cycleSave","phaseSave","roadmapRepo","ModalDeleteCancel","ModalEvents","showDeleteConfirmModal","message","title","create","body","then","modal","Promise","resolve","show","getRoot","on","delete","hide","cancel","hidden","destroy","getMaxValue","dataType","ids","each","id","parseInt","this","data","isNaN","push","length","Math","max","moveWrapper","$wrapper","direction","$prev","prev","insertBefore","$next","next","insertAfter","colorPatternCache","RoadmapConfig","constructor","inputSelector","inputConfig","configContainer","initForm","config","inputConfigVal","val","JSON","stringify","phases","parse","e","exception","forEach","phase","configuration","cycles","cycle","steps","step","render","html","js","prependNodeContents","bindExpandCollapseControls","off","clickHandler","phaseColorChange","refreshChecklists","rebindButtons","rebindInputs","bindConfigSave","require","catch","target","event","$node","currentTarget","action","actionMap","collapsePhases","expandPhases","collapseCycles","closest","find","first","expandCycles","collapseSteps","parent","expandSteps","collapsePhase","collapseCycle","collapseStep","deletePhase","deleteCycle","deleteStep","addPhase","upPhase","downPhase","addCycle","upCycle","downCycle","addStep","upStep","downStep","colorId","applyColorSet","fetchColorPattern","colors","remove","$colorTable","addClass","color","append","i","idxColor","css","configSave","$phaseContainer","roadmapData","index","phaseData","phaseDataObj","phaseDeletes","cycleDeletes","stepDeletes","$roadmapConfigInput","nextIndex","newPhase","number","subtitle","appendNodeContents","$cycleContainer","children","nextCycleIndex","newCycle","$stepsContainer","nextStepIndex","maxStepId","iconUrl","newStep","stepicon","iconurl","preventDefault","collapseEverything","expandEverything","expandChildrenClass","node","collapseChildrenClass","$parent","className","hasClass","click","$container","expandCollapse","confirmed","phaseId","$phaseDeletes","cycleId","$cycleDeletes","triggerHandler","stepId","$stepDeletes","init"],"mappings":"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"}