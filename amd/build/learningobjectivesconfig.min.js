define ("mod_roadmap/learningobjectivesconfig",["jquery","core/notification","core/templates"],function(a,b,c){var d=function(b,c){this.inputSelector=a(b).parent();this.configContainer=a(c);this.showConfig(this)};d.prototype.showConfig=function(){var e=this,f=this.configContainer.val();if(""==f){f=JSON.stringify({learningobjectives:[]});this.configContainer.val(f)}var g=JSON.parse(f);g.learningobjectives.forEach(function(a){a.number=a.index+1});c.render("mod_roadmap/configuration_learningobjectives",g).then(function(f,g){c.prependNodeContents(e.inputSelector,f,g);a(".learning-objective-name").change(function(){d.prototype.saveConfig()});a("#add-learning-objective").click(function(f){f.preventDefault();var e=a("#learningobjective-container").children(".learningobjective").length;c.render("mod_roadmap/configuration_learningobjective",{id:e,number:e+1}).then(function(b,e){c.appendNodeContents("#learningobjective-container",b,e);d.prototype.saveConfig();a(".learning-objective-name").unbind("change").change(function(){d.prototype.saveConfig()})}).fail(b.exception)})}).fail(b.exception)};d.prototype.saveConfig=function(){var b=[];a("#learningobjective-container").children(".learningobjective").each(function(c){var d=a("#learningobjective-container").children(".learningobjective")[c],e=a(d).data("id"),f=a(d).find("input.learning-objective-name").val();b.push({index:c,id:e,name:f})});a("#id_learningobjectivesconfiguration").val(JSON.stringify({learningobjectives:b}));d.prototype.refreshChecklists()};d.prototype.refreshChecklists=function(){var b=JSON.parse(a("#id_learningobjectivesconfiguration").val()),c=a(".chk-learning-objectives");a(c).each(function(c,d){var e=[],f=a(this).closest(".cycle-container").children(".cycle-configuration").val();if(""!=f){var g=JSON.parse(f);e=g.learningobjectives.split(",").map(function(a){return parseInt(a)})}a(d).empty();b.learningobjectives.forEach(function(b){var c=a("<li/>").attr("data-id",b.id).appendTo(a(d));a("<input/>").attr("type","checkbox").attr("value",b.id).attr("class","form-control").attr("checked",0<=a.inArray(b.id,e)).appendTo(c);a("<span>").text(b.name).appendTo(c)})})};return{init:function init(a,b){return new d(a,b)},refresh_checklists:function refresh_checklists(){d.prototype.refreshChecklists()}}});
//# sourceMappingURL=learningobjectivesconfig.min.js.map
