{"version":3,"sources":["../src/phase_save.js"],"names":["define","$","PhaseSave","prototype","rebind_inputs","unbind","change","savePhase","bind","event","phaseContainer","target","closest","phaseCycles","index","each","find","cycleData","val","cycleDataObj","JSON","parse","id","push","phaseData","title","cycles","children","stringify","triggerHandler","init"],"mappings":"AAsBAA,OAAM,0BAAC,CAAC,QAAD,CAAD,CACF,SAASC,CAAT,CAAY,CAER,GAAIC,CAAAA,CAAS,CAAG,UAAW,CAE1B,CAFD,CAIAA,CAAS,CAACC,SAAV,CAAoBC,aAApB,CAAoC,UAAW,CAC3CH,CAAC,CAAC,cAAD,CAAD,CAAkBI,MAAlB,CAAyB,QAAzB,EAAmCC,MAAnC,CAA0C,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA1C,EACAP,CAAC,CAAC,6DAAD,CAAD,CAAiEI,MAAjE,CAAwE,QAAxE,EAAkFC,MAAlF,CAAyF,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAzF,EACAN,CAAS,CAACC,SAAV,CAAoBI,SAApB,CAA8B,IAA9B,CACH,CAJD,CAMAL,CAAS,CAACC,SAAV,CAAoBI,SAApB,CAAgC,SAASE,CAAT,CAAgB,IACxCC,CAAAA,CAAc,CAAGT,CAAC,CAACQ,CAAK,CAACE,MAAP,CAAD,CAAgBC,OAAhB,CAAwB,kBAAxB,CADuB,CAExCC,CAAW,CAAG,EAF0B,CAGxCC,CAAK,CAAG,CAHgC,CAI5Cb,CAAC,CAACc,IAAF,CAAOL,CAAc,CAACM,IAAf,CAAoB,6DAApB,CAAP,CAA2F,UAAW,CAClG,GAAIC,CAAAA,CAAS,CAAGhB,CAAC,CAAC,IAAD,CAAD,CAAQiB,GAAR,EAAhB,CACA,GAAiB,EAAb,EAAAD,CAAJ,CAAqB,CAAEA,CAAS,CAAG,IAAO,CAC1C,GAAIE,CAAAA,CAAY,CAAGC,IAAI,CAACC,KAAL,CAAWJ,CAAX,CAAnB,CACAE,CAAY,CAACL,KAAb,CAAqBA,CAArB,CACAA,CAAK,CAAGA,CAAK,CAAG,CAAhB,CACAK,CAAY,CAACG,EAAb,CAAkBR,CAAlB,CACAD,CAAW,CAACU,IAAZ,CAAiBJ,CAAjB,CACH,CARD,EASA,GAAIK,CAAAA,CAAS,CAAG,CACZC,KAAK,CAAEf,CAAc,CAACM,IAAf,CAAoB,0BAApB,EAAgDE,GAAhD,EADK,CAEZQ,MAAM,CAAEb,CAFI,CAAhB,CAIAH,CAAc,CAACiB,QAAf,CAAwB,2BAAxB,EAAqDT,GAArD,CAAyDE,IAAI,CAACQ,SAAL,CAAeJ,CAAf,CAAzD,EAAoFK,cAApF,CAAmG,QAAnG,CACH,CAlBD,CAoBA,MAAO,CAEHC,IAAI,CAAE,eAAW,CACb,MAAO,IAAI5B,CAAAA,CACd,CAJE,CAMHE,aAAa,CAAE,wBAAW,CACtBF,CAAS,CAACC,SAAV,CAAoBC,aAApB,EACH,CARE,CAUV,CA3CC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle opening a dialogue to configure scale data.\n *\n * @module     mod_roadmap/stepiconselect\n * @package    mod_roadmap\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'],\n    function($) {\n\n        var PhaseSave = function() {\n\n        };\n\n        PhaseSave.prototype.rebind_inputs = function() {\n            $('.phase-title').unbind('change').change(this.savePhase.bind(this));\n            $('.phase-cycles-container .cycle-wrapper .cycle-configuration').unbind('change').change(this.savePhase.bind(this));\n            PhaseSave.prototype.savePhase(this);\n        };\n\n        PhaseSave.prototype.savePhase = function(event) {\n            var phaseContainer = $(event.target).closest('.phase-container');\n            var phaseCycles = [];\n            let index = 0;\n            $.each(phaseContainer.find('.phase-cycles-container .cycle-wrapper .cycle-configuration'), function() {\n                let cycleData = $(this).val();\n                if (cycleData == '') { cycleData = '{}'; }\n                let cycleDataObj = JSON.parse(cycleData);\n                cycleDataObj.index = index;\n                index = index + 1;\n                cycleDataObj.id = index;\n                phaseCycles.push(cycleDataObj);\n            });\n            var phaseData = {\n                title: phaseContainer.find('.fitem input.phase-title').val(),\n                cycles: phaseCycles,\n            };\n            phaseContainer.children('input.phase-configuration').val(JSON.stringify(phaseData)).triggerHandler(\"change\");\n        };\n\n        return {\n\n            init: function() {\n                return new PhaseSave();\n            },\n\n            rebind_inputs: function() {\n                PhaseSave.prototype.rebind_inputs();\n            }\n        };\n    });"],"file":"phase_save.min.js"}