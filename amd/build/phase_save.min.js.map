{"version":3,"file":"phase_save.min.js","sources":["../src/phase_save.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle opening a dialogue to configure scale data.\n *\n * @module     mod_roadmap/stepiconselect\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'],\n    function($) {\n\n        var PhaseSave = function() {\n            // Do nothing.\n        };\n\n        PhaseSave.prototype.rebindInputs = function() {\n            $('.phase-title').unbind('change').change(this.savePhase.bind(this));\n            $('.phase-cycles-container .cycle-wrapper .cycle-configuration').unbind('change').change(this.savePhase.bind(this));\n            PhaseSave.prototype.savePhase(this);\n        };\n\n        PhaseSave.prototype.savePhase = function(event) {\n            var phaseContainer = $(event.target).closest('.phase-container');\n            var phaseCycles = [];\n            let index = 0;\n            $.each(phaseContainer.find('.phase-cycles-container .cycle-wrapper .cycle-configuration'), function() {\n                let cycleData = $(this).val();\n                if (cycleData == '') {\n                    cycleData = '{}';\n                }\n                let cycleDataObj = JSON.parse(cycleData);\n                cycleDataObj.index = index;\n                index = index + 1;\n                phaseCycles.push(cycleDataObj);\n            });\n            let title = phaseContainer.find('.fitem input.phase-title').val();\n            var phaseData = {\n                id: phaseContainer.closest('.phase-wrapper').data('phaseid'),\n                title: title,\n                cycles: phaseCycles,\n            };\n            phaseContainer.closest('.phase-wrapper').find('.phase-header-title').html(title);\n            phaseContainer.children('input.phase-configuration').val(JSON.stringify(phaseData)).triggerHandler(\"change\");\n        };\n\n        return {\n\n            init: function() {\n                return new PhaseSave();\n            },\n\n            rebindInputs: function() {\n                PhaseSave.prototype.rebindInputs();\n            }\n        };\n    });"],"names":["define","$","PhaseSave","prototype","rebindInputs","unbind","change","this","savePhase","bind","event","phaseContainer","target","closest","phaseCycles","index","each","find","cycleData","val","cycleDataObj","JSON","parse","push","title","phaseData","id","data","cycles","html","children","stringify","triggerHandler","init"],"mappings":";;;;;;AAqBAA,gCAAO,CAAC,WACJ,SAASC,OAEDC,UAAY,oBAIhBA,UAAUC,UAAUC,aAAe,WAC/BH,EAAE,gBAAgBI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OAC9DN,EAAE,+DAA+DI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OAC7GL,UAAUC,UAAUK,UAAUD,OAGlCL,UAAUC,UAAUK,UAAY,SAASE,WACjCC,eAAiBV,EAAES,MAAME,QAAQC,QAAQ,oBACzCC,YAAc,OACdC,MAAQ,EACZd,EAAEe,KAAKL,eAAeM,KAAK,gEAAgE,eACnFC,UAAYjB,EAAEM,MAAMY,MACP,IAAbD,YACAA,UAAY,UAEZE,aAAeC,KAAKC,MAAMJ,WAC9BE,aAAaL,MAAQA,MACrBA,OAAgB,EAChBD,YAAYS,KAAKH,qBAEjBI,MAAQb,eAAeM,KAAK,4BAA4BE,UACxDM,UAAY,CACZC,GAAIf,eAAeE,QAAQ,kBAAkBc,KAAK,WAClDH,MAAOA,MACPI,OAAQd,aAEZH,eAAeE,QAAQ,kBAAkBI,KAAK,uBAAuBY,KAAKL,OAC1Eb,eAAemB,SAAS,6BAA6BX,IAAIE,KAAKU,UAAUN,YAAYO,eAAe,WAGhG,CAEHC,KAAM,kBACK,IAAI/B,WAGfE,aAAc,WACVF,UAAUC,UAAUC"}