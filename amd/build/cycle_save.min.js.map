{"version":3,"file":"cycle_save.min.js","sources":["../src/cycle_save.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle opening a dialogue to configure scale data.\n *\n * @module     mod_roadmap/stepiconselect\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'],\n    function($) {\n\n        var CycleSave = function() {\n            // Do nothing.\n        };\n\n        CycleSave.prototype.rebindInputs = function() {\n\n            $('.cycle-title').unbind('change').change(this.saveCycle.bind(this));\n            $('.cycle-subtitle').unbind('change').change(this.saveCycle.bind(this));\n            $('.cycle-pagelink').unbind('change').change(this.saveCycle.bind(this));\n            $('.chk-learning-objectives input[type=\"checkbox\"]').unbind('change').change(this.saveCycle.bind(this));\n            $('.cycle-steps-container .step-wrapper .step-configuration').unbind('change').change(this.saveCycle.bind(this));\n            CycleSave.prototype.saveCycle(this);\n        };\n\n        CycleSave.prototype.saveCycle = function(event) {\n\n            var cycleContainer = $(event.target).closest('.cycle-container');\n            var cycleLos = [];\n            $.each(cycleContainer.find('.chk-learning-objectives input[type=\"checkbox\"]'), function() {\n                if ($(this).prop(\"checked\") == true) {\n                    cycleLos.push($(this).val());\n                }\n            });\n\n            var cycleSteps = [];\n            $.each(cycleContainer.find('.cycle-steps-container .step-wrapper .step-configuration'), function() {\n                let stepData = $(this).val();\n                if (stepData == '') {\n                    stepData = '{}';\n                }\n                cycleSteps.push(JSON.parse(stepData));\n            });\n            let title = cycleContainer.find('.fitem input.cycle-title').val();\n            var cycleData = {\n                id: cycleContainer.closest('.cycle-wrapper').data('cycleid'),\n                title: title,\n                subtitle: cycleContainer.find('.fitem input.cycle-subtitle').val(),\n                pagelink: cycleContainer.find('.fitem input.cycle-pagelink').val(),\n                learningobjectives: cycleLos.join(\",\"),\n                steps: cycleSteps,\n            };\n            cycleContainer.closest('.cycle-wrapper').find('.cycle-header-title').html(title);\n            cycleContainer.children('input.cycle-configuration').val(JSON.stringify(cycleData)).triggerHandler(\"change\");\n        };\n\n        return {\n\n            init: function() {\n                return new CycleSave();\n            },\n\n            rebindInputs: function() {\n                CycleSave.prototype.rebindInputs();\n            }\n        };\n    });"],"names":["define","$","CycleSave","prototype","rebindInputs","unbind","change","this","saveCycle","bind","event","cycleContainer","target","closest","cycleLos","each","find","prop","push","val","cycleSteps","stepData","JSON","parse","title","cycleData","id","data","subtitle","pagelink","learningobjectives","join","steps","html","children","stringify","triggerHandler","init"],"mappings":";;;;;;AAqBAA,gCAAO,CAAC,WACJ,SAASC,OAEDC,UAAY,oBAIhBA,UAAUC,UAAUC,aAAe,WAE/BH,EAAE,gBAAgBI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OAC9DN,EAAE,mBAAmBI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OACjEN,EAAE,mBAAmBI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OACjEN,EAAE,mDAAmDI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OACjGN,EAAE,4DAA4DI,OAAO,UAAUC,OAAOC,KAAKC,UAAUC,KAAKF,OAC1GL,UAAUC,UAAUK,UAAUD,OAGlCL,UAAUC,UAAUK,UAAY,SAASE,WAEjCC,eAAiBV,EAAES,MAAME,QAAQC,QAAQ,oBACzCC,SAAW,GACfb,EAAEc,KAAKJ,eAAeK,KAAK,oDAAoD,WAC5C,GAA3Bf,EAAEM,MAAMU,KAAK,YACbH,SAASI,KAAKjB,EAAEM,MAAMY,cAI1BC,WAAa,GACjBnB,EAAEc,KAAKJ,eAAeK,KAAK,6DAA6D,eAChFK,SAAWpB,EAAEM,MAAMY,MACP,IAAZE,WACAA,SAAW,MAEfD,WAAWF,KAAKI,KAAKC,MAAMF,kBAE3BG,MAAQb,eAAeK,KAAK,4BAA4BG,UACxDM,UAAY,CACZC,GAAIf,eAAeE,QAAQ,kBAAkBc,KAAK,WAClDH,MAAOA,MACPI,SAAUjB,eAAeK,KAAK,+BAA+BG,MAC7DU,SAAUlB,eAAeK,KAAK,+BAA+BG,MAC7DW,mBAAoBhB,SAASiB,KAAK,KAClCC,MAAOZ,YAEXT,eAAeE,QAAQ,kBAAkBG,KAAK,uBAAuBiB,KAAKT,OAC1Eb,eAAeuB,SAAS,6BAA6Bf,IAAIG,KAAKa,UAAUV,YAAYW,eAAe,WAGhG,CAEHC,KAAM,kBACK,IAAInC,WAGfE,aAAc,WACVF,UAAUC,UAAUC"}