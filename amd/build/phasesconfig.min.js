define ("mod_roadmap/phasesconfig",["jquery","core/notification","core/templates","mod_roadmap/expand_contract","mod_roadmap/learningobjectivesconfig"],function(a,b,c,d,e){var f=function(b,c){this.inputSelector=b;this.configContainer=a(c);this.showConfig(this)};f.prototype.showConfig=function(){var d=this,g=JSON.parse(this.configContainer.val());c.render("mod_roadmap/configuration_phases",g).then(function(b,g){c.prependNodeContents(d.inputSelector,b,g);e.refreshChecklists();a("#add-phase").click(function(a){f.prototype.addPhase(a)});a(".add-phase-cycle").click(function(a){f.prototype.addCycle(a)});a(".add-cycle-step").click(function(a){f.prototype.addStep(a)});a(".phase-collapse-control").click(function(a){f.prototype.collapsePhase(a)});a(".cycle-collapse-control").click(function(a){f.prototype.collapseCycle(a)});a(".step-collapse-control").click(function(a){f.prototype.collapseStep(a)})}).fail(b.exception)};f.prototype.addPhase=function(d){d.preventDefault();d.stopPropagation();var e=JSON.parse(a("input[name=\"roadmapconfiguration\"]").val()),g=e.phases.length,h={id:-1,index:g,number:g+1};e.phases.push(h);a("input[name=\"roadmapconfiguration\"]").val(JSON.stringify(e));c.render("mod_roadmap/configuration_phase",h).then(function(b,d){c.appendNodeContents("#phase-container",b,d);a(".phase-collapse-control").unbind("click").click(function(a){f.prototype.collapsePhase(a)});a("#add-phase").unbind("click").click(function(a){f.prototype.addPhase(a)})}).fail(b.exception)};f.prototype.addCycle=function(d){d.preventDefault();d.stopPropagation();var e=a(d.currentTarget),g=e.closest(".phase-container"),h=g.children(".phase-cycles-container"),i=h.children(".cycle-wrapper").length;c.render("mod_roadmap/configuration_cycle",{id:-1,index:i,number:i+1}).then(function(b,d){c.appendNodeContents(h,b,d);a(".cycle-collapse-control").unbind("click").click(function(a){f.prototype.collapseCycle(a)});a(".add-cycle-step").unbind("click").click(function(a){f.prototype.addStep(a)})}).fail(b.exception)};f.prototype.addStep=function(d){d.preventDefault();d.stopPropagation();var e=a(d.currentTarget),g=e.closest(".cycle-container"),h=g.children(".cycle-steps-container"),i=h.children(".step-wrapper").length;c.render("mod_roadmap/configuration_step",{id:-1,index:i,number:i+1}).then(function(b,d){c.appendNodeContents(h,b,d);a(".step-collapse-control").unbind("click").click(function(a){f.prototype.collapseStep(a)})}).fail(b.exception)};f.prototype.collapsePhase=function(b){b.preventDefault();b.stopPropagation();var c=a(b.currentTarget),e=c.closest(".phase-wrapper"),f=e.children(".phase-container");d.expandCollapse(f,c)};f.prototype.collapseCycle=function(b){b.preventDefault();b.stopPropagation();var c=a(b.currentTarget),e=c.closest(".cycle-wrapper"),f=e.children(".cycle-container");d.expandCollapse(f,c)};f.prototype.collapseStep=function(b){b.preventDefault();b.stopPropagation();var c=a(b.currentTarget),e=c.closest(".step-wrapper"),f=e.children(".step-container");d.expandCollapse(f,c)};return{init:function init(a,b){return new f(a,b)}}});
//# sourceMappingURL=phasesconfig.min.js.map
