define ("mod_roadmap/roadmap_config",["jquery","core/notification","core/templates","mod_roadmap/expand_contract","mod_roadmap/learningobjectivesconfig","mod_roadmap/step_icon_select","mod_roadmap/step_activity_select"],function(a,b,c,d,e,f,g){var h=function(b,c){this.inputSelector=b;this.configContainer=a(c);this.showConfig(this)};h.prototype.showConfig=function(){var d=this,i=JSON.parse(this.configContainer.val());c.render("mod_roadmap/configuration_phases",i).then(function(b,i){c.prependNodeContents(d.inputSelector,b,i);a("#add-phase").click(function(a){h.prototype.addPhase(a)});a(".add-phase-cycle").click(function(a){h.prototype.addCycle(a)});a(".add-cycle-step").click(function(a){h.prototype.addStep(a)});a(".phase-collapse-control").click(function(a){h.prototype.collapsePhase(a)});a(".cycle-collapse-control").click(function(a){h.prototype.collapseCycle(a)});a(".step-collapse-control").click(function(a){h.prototype.collapseStep(a)});e.refresh_checklists();f.rebind_buttons();g.rebind_buttons()}).fail(b.exception)};h.prototype.addPhase=function(d){d.preventDefault();d.stopPropagation();var e=JSON.parse(a("input[name=\"roadmapconfiguration\"]").val()),f=e.phases.length,g={id:-1,index:f,number:f+1};e.phases.push(g);a("input[name=\"roadmapconfiguration\"]").val(JSON.stringify(e));c.render("mod_roadmap/configuration_phase",g).then(function(b,d){c.appendNodeContents("#phase-container",b,d);a(".phase-collapse-control").unbind("click").click(function(a){h.prototype.collapsePhase(a)});a("#add-phase").unbind("click").click(function(a){h.prototype.addPhase(a)})}).fail(b.exception)};h.prototype.addCycle=function(d){d.preventDefault();d.stopPropagation();var f=a(d.currentTarget),g=f.closest(".phase-container"),i=g.children(".phase-cycles-container"),j=i.children(".cycle-wrapper").length;c.render("mod_roadmap/configuration_cycle",{id:-1,index:j,number:j+1}).then(function(b,d){c.appendNodeContents(i,b,d);a(".cycle-collapse-control").unbind("click").click(function(a){h.prototype.collapseCycle(a)});a(".add-cycle-step").unbind("click").click(function(a){h.prototype.addStep(a)});e.refresh_checklists()}).fail(b.exception)};h.prototype.addStep=function(d){d.preventDefault();d.stopPropagation();var e=a(d.currentTarget),i=e.closest(".cycle-container"),j=i.children(".cycle-steps-container"),k=j.children(".step-wrapper").length;c.render("mod_roadmap/configuration_step",{id:-1,index:k,number:k+1}).then(function(b,d){c.appendNodeContents(j,b,d);a(".step-collapse-control").unbind("click").click(function(a){h.prototype.collapseStep(a)});f.rebind_buttons();g.rebind_buttons()}).fail(b.exception)};h.prototype.collapsePhase=function(b){b.preventDefault();b.stopPropagation();var c=a(b.currentTarget),e=c.closest(".phase-wrapper"),f=e.children(".phase-container");d.expandCollapse(f,c)};h.prototype.collapseCycle=function(b){b.preventDefault();b.stopPropagation();var c=a(b.currentTarget),e=c.closest(".cycle-wrapper"),f=e.children(".cycle-container");d.expandCollapse(f,c)};h.prototype.collapseStep=function(b){b.preventDefault();b.stopPropagation();var c=a(b.currentTarget),e=c.closest(".step-wrapper"),f=e.children(".step-container");d.expandCollapse(f,c)};return{init:function init(a,b){return new h(a,b)}}});
//# sourceMappingURL=roadmap_config.min.js.map
