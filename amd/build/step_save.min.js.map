{"version":3,"file":"step_save.min.js","sources":["../src/step_save.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle opening a dialogue to configure scale data.\n *\n * @module     mod_roadmap/stepsave\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'],\n    function($) {\n\n        var StepSave = function() {\n            // Do nothing.\n        };\n\n        StepSave.prototype.rebindInputs = function() {\n            // Rebind any new fields with save step on change.\n            $('.roadmap-form-control-step')\n                .unbind('change')\n                .change(this.saveStep.bind(this));\n\n            // Run save step if a new field has been added.\n            StepSave.prototype.saveStep(this);\n        };\n\n        StepSave.prototype.saveStep = function(event) {\n            // Find step container that we are saving data from.\n            var stepContainer = $(event.target).closest('.step-container');\n\n            // Expected complete check box option.\n            var expectedComplete = 0;\n            if (stepContainer.find('.completionexpected').prop(\"checked\") == true) {\n                expectedComplete = 1;\n            }\n\n            // Link single activity check box option.\n            var linksingleactivity = 0;\n            if (stepContainer.find('.fitem input.chk-single-activity-link').prop(\"checked\") == true) {\n                linksingleactivity = 1;\n            }\n\n            // Save rollover text and use to set the step header title.\n            let rollovertext = stepContainer.find('.fitem input.step-rollovertext').val();\n\n            // Step data object collection.\n            var stepData = {\n                id: stepContainer.closest('.step-wrapper').data('stepid'),\n                rollovertext: rollovertext,\n                stepicon: stepContainer.find('.fitem input.step-icon').val(),\n                completionmodules: stepContainer.find('.fitem input.step-completion-modules').val(),\n                linksingleactivity: linksingleactivity,\n                pagelink: stepContainer.find('.fitem input.step-single-activity-link').val(),\n                expectedcomplete: expectedComplete,\n                completionexpectedday: stepContainer.find('.fitem select.completionexpectedday').val(),\n                completionexpectedmonth: stepContainer.find('.fitem select.completionexpectedmonth').val(),\n                completionexpectedyear: stepContainer.find('.fitem select.completionexpectedyear').val(),\n                completionexpectedhour: stepContainer.find('.fitem select.completionexpectedhour').val(),\n                completionexpectedminute: stepContainer.find('.fitem select.completionexpectedminute').val(),\n            };\n\n            // Clean up data object calendar binding data.\n            delete stepData.days;\n            delete stepData.months;\n            delete stepData.years;\n            delete stepData.hours;\n            delete stepData.minutes;\n\n            // Set the header title with the new step roll over text and save the step data object as json to config.\n            stepContainer.closest('.step-wrapper').find('.step-header-title').html(rollovertext);\n            stepContainer.children('input.step-configuration').val(JSON.stringify(stepData)).triggerHandler(\"change\");\n        };\n\n        return {\n            init: function() {\n                return new StepSave();\n            },\n\n            rebindInputs: function() {\n                StepSave.prototype.rebindInputs();\n            }\n        };\n    });"],"names":["define","$","StepSave","prototype","rebindInputs","unbind","change","this","saveStep","bind","event","stepContainer","target","closest","expectedComplete","find","prop","linksingleactivity","rollovertext","val","stepData","id","data","stepicon","completionmodules","pagelink","expectedcomplete","completionexpectedday","completionexpectedmonth","completionexpectedyear","completionexpectedhour","completionexpectedminute","days","months","years","hours","minutes","html","children","JSON","stringify","triggerHandler","init"],"mappings":";;;;;;AAqBAA,+BAAO,CAAC,WACJ,SAASC,OAEDC,SAAW,oBAIfA,SAASC,UAAUC,aAAe,WAE9BH,EAAE,8BACGI,OAAO,UACPC,OAAOC,KAAKC,SAASC,KAAKF,OAG/BL,SAASC,UAAUK,SAASD,OAGhCL,SAASC,UAAUK,SAAW,SAASE,WAE/BC,cAAgBV,EAAES,MAAME,QAAQC,QAAQ,mBAGxCC,iBAAmB,EAC0C,GAA7DH,cAAcI,KAAK,uBAAuBC,KAAK,aAC/CF,iBAAmB,OAInBG,mBAAqB,EAC0D,GAA/EN,cAAcI,KAAK,yCAAyCC,KAAK,aACjEC,mBAAqB,OAIrBC,aAAeP,cAAcI,KAAK,kCAAkCI,UAGpEC,SAAW,CACXC,GAAIV,cAAcE,QAAQ,iBAAiBS,KAAK,UAChDJ,aAAcA,aACdK,SAAUZ,cAAcI,KAAK,0BAA0BI,MACvDK,kBAAmBb,cAAcI,KAAK,wCAAwCI,MAC9EF,mBAAoBA,mBACpBQ,SAAUd,cAAcI,KAAK,0CAA0CI,MACvEO,iBAAkBZ,iBAClBa,sBAAuBhB,cAAcI,KAAK,uCAAuCI,MACjFS,wBAAyBjB,cAAcI,KAAK,yCAAyCI,MACrFU,uBAAwBlB,cAAcI,KAAK,wCAAwCI,MACnFW,uBAAwBnB,cAAcI,KAAK,wCAAwCI,MACnFY,yBAA0BpB,cAAcI,KAAK,0CAA0CI,cAIpFC,SAASY,YACTZ,SAASa,cACTb,SAASc,aACTd,SAASe,aACTf,SAASgB,QAGhBzB,cAAcE,QAAQ,iBAAiBE,KAAK,sBAAsBsB,KAAKnB,cACvEP,cAAc2B,SAAS,4BAA4BnB,IAAIoB,KAAKC,UAAUpB,WAAWqB,eAAe,WAG7F,CACHC,KAAM,kBACK,IAAIxC,UAGfE,aAAc,WACVF,SAASC,UAAUC"}