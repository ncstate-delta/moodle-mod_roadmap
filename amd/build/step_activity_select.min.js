define ("mod_roadmap/step_activity_select",["jquery","core/notification","core/templates","core/ajax","mod_roadmap/dialogue","mod_roadmap/step_save"],function(a,b,c,d,e,f){var g=function(){};g.prototype.rebind_checkbox=function(){console.log("StepActivitySelector.prototype.rebind_checkbox");a(".chk-single-activity-link").unbind("click").each(function(b,c){var d=a(c).data("stepid");a("#step-"+d+"-single-activity-link").prop("disabled",a(c).prop("checked"));a(c).click(function(){var b=a(this).data("stepid");a("#step-"+b+"-single-activity-link").prop("disabled",a(this).prop("checked"))})});a(".completion-modules").unbind("change").each(function(a,b){g.prototype.configure_checkbox(b)})};g.prototype.configure_checkbox=function(b){console.log("StepActivitySelector.prototype.configure_checkbox");var c=a(b).data("stepid"),d=1<a("#step-"+c+"-completion-modules").val().split(",").length;a("#step-"+c+"-chk-single-activity-link").prop("disabled",d);if(d){a("#step-"+c+"-chk-single-activity-link").prop("checked",!d);a("#step-"+c+"-single-activity-link").prop("disabled",!d)}};g.prototype.rebind_buttons=function(){console.log("StepActivitySelector.prototype.rebind_buttons");a(".btn_completion_selector").unbind("click").click(this.showConfig.bind(this))};g.prototype.showConfig=function(d){console.log("StepActivitySelector.prototype.showConfig");var f=this,g=JSON.parse(a("input[name=\"activity_data\"]").val());f.clickedButton=d.target;c.render("mod_roadmap/configuration_activityselect",g).done(function(a){new e("Select Activities for Step Completion",a,f.initActivityConfig.bind(f))}).fail(b.exception)};g.prototype.loadList=function(){console.log("StepActivitySelector.prototype.loadList");var b=JSON.parse(a("input[name=\"activity_data\"]").val()),c=a("ul.step-completion-list");a(c).each(function(c,d){var e=a(this).closest(".step-activity-container").find(".step-completion-modules").val(),f=e.split(",");a(d).children("li").remove();console.log(b.activities);console.log(b.activities[0]);b.activities.forEach(function(b){if(0<=a.inArray(b.coursemoduleid,f)){var c=a("<li/>").attr("data-id",b.coursemoduleid).appendTo(a(d));a("<span>").text(b.name).appendTo(c);a(d).append(c)}});a(d).trigger("change");g.prototype.configure_checkbox(a(this).closest(".step-activity-container").find(".step-completion-modules"))})};g.prototype.initActivityConfig=function(b){console.log("StepActivitySelector.prototype.initActivityConfig");this.popup=b;var c=a(b.getContent());c.on("click","[data-action=\"save\"]",function(){var c=a("#step-activity-selector option:selected").toArray().map(function(a){return a.value}).join(","),d=a(this.clickedButton).data("stepid");a("#step-"+d+"-completion-modules").val(c).trigger("change");g.prototype.loadList();f.rebind_inputs();b.close()}.bind(this));c.on("click","[data-action=\"cancel\"]",function(){b.close()})};return{init:function init(){return new g},rebind_buttons:function rebind_buttons(){g.prototype.rebind_buttons();g.prototype.rebind_checkbox();g.prototype.loadList()}}});
//# sourceMappingURL=step_activity_select.min.js.map
